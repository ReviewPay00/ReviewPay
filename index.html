<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ReviewPay</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: {
              sans: ['Space Grotesk', 'system-ui', 'sans-serif']
            },
            colors: {
              ink: {
                900: '#0b1220',
                800: '#121b2e',
                700: '#1d2740',
                600: '#2a3758'
              },
              glow: {
                400: '#5eead4',
                500: '#38bdf8',
                600: '#6366f1'
              }
            }
          }
        }
      };
    </script>
    <style>
      .sidebar {
        width: 72px;
        transition: width 0.25s ease;
        overflow: hidden;
        padding-left: 12px;
        padding-right: 12px;
        position: fixed;
        top: 0;
        left: 0;
        height: 100vh;
        z-index: 40;
      }

      .sidebar:hover {
        width: 260px;
        padding-left: 16px;
        padding-right: 16px;
      }

      .sidebar-hover-spacer {
        width: 72px;
        transition: width 0.25s ease;
        flex-shrink: 0;
      }

      .sidebar:hover + .sidebar-hover-spacer {
        width: 260px;
      }

      .sidebar .sidebar-text {
        opacity: 0;
        transform: translateX(-8px);
        transition: opacity 0.2s ease, transform 0.2s ease;
        pointer-events: none;
        white-space: nowrap;
        max-width: 0;
        overflow: hidden;
      }

      .sidebar:hover .sidebar-text {
        opacity: 1;
        transform: translateX(0);
        pointer-events: auto;
        max-width: 240px;
      }

      .sidebar .nav-item {
        justify-content: center;
        gap: 0;
      }

      .sidebar:hover .nav-item {
        justify-content: flex-start;
        gap: 12px;
      }

      .sidebar:not(:hover) .sidebar-logo {
        justify-content: center;
        gap: 0;
      }

      .plan-badge {
        position: relative;
        animation: planPulse 2.2s ease-in-out infinite;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
      }

      .plan-badge:hover {
        transform: translateY(-4px) scale(1.03);
        box-shadow: 0 14px 30px -18px rgba(56, 189, 248, 0.8);
        animation-play-state: paused;
      }

      @keyframes planPulse {
        0% {
          box-shadow: 0 0 0 0 rgba(56, 189, 248, 0.35);
        }
        70% {
          box-shadow: 0 0 0 12px rgba(56, 189, 248, 0);
        }
        100% {
          box-shadow: 0 0 0 0 rgba(56, 189, 248, 0);
        }
      }

      .nav-item {
        transition: background 0.2s ease, color 0.2s ease, transform 0.2s ease;
      }

      .nav-item:hover {
        transform: translateX(3px);
      }

      .toast {
        background: linear-gradient(135deg, rgba(30,41,59,0.92), rgba(15,23,42,0.95));
        border: 1px solid rgba(148,163,184,0.2);
        box-shadow: 0 18px 50px -30px rgba(15, 23, 42, 0.85);
        padding: 12px 14px;
        border-radius: 16px;
        display: grid;
        gap: 6px;
        color: #e2e8f0;
        animation: toastIn 0.35s ease forwards;
      }

      .toast-success {
        border-color: rgba(52, 211, 153, 0.4);
      }

      .toast-warning {
        border-color: rgba(250, 204, 21, 0.45);
      }

      .toast-info {
        border-color: rgba(56, 189, 248, 0.4);
      }

      .toast-title {
        font-size: 0.85rem;
        font-weight: 600;
      }

      .toast-message {
        font-size: 0.75rem;
        color: rgba(226, 232, 240, 0.8);
      }

      .toast-exit {
        animation: toastOut 0.35s ease forwards;
      }

      @keyframes toastIn {
        from {
          transform: translateY(-10px);
          opacity: 0;
        }
        to {
          transform: translateY(0);
          opacity: 1;
        }
      }

      @keyframes toastOut {
        from {
          transform: translateY(0);
          opacity: 1;
        }
        to {
          transform: translateY(-10px);
          opacity: 0;
        }
      }

      .confetti {
        position: fixed;
        inset: 0;
        pointer-events: none;
        z-index: 70;
      }

      .confetti-piece {
        position: absolute;
        width: 8px;
        height: 14px;
        opacity: 0.9;
        animation: confettiFall 1.6s ease forwards;
      }

      @keyframes confettiFall {
        0% {
          transform: translateY(-20px) rotate(0deg);
          opacity: 1;
        }
        100% {
          transform: translateY(120vh) rotate(360deg);
          opacity: 0;
        }
      }

      .privacy-blur {
        filter: blur(6px);
        opacity: 0.35;
      }

      .celebrate {
        animation: screenShake 0.4s ease;
      }

      @keyframes screenShake {
        0% { transform: translateX(0); }
        20% { transform: translateX(-4px); }
        40% { transform: translateX(4px); }
        60% { transform: translateX(-3px); }
        80% { transform: translateX(3px); }
        100% { transform: translateX(0); }
      }
    </style>
  </head>
  <body class="bg-ink-900 text-white">
    <div id="authView" class="min-h-screen">
      <div class="absolute inset-0 overflow-hidden">
        <div class="absolute -top-40 -left-32 h-96 w-96 rounded-full bg-glow-600/20 blur-[120px]"></div>
        <div class="absolute bottom-0 right-0 h-96 w-96 rounded-full bg-glow-500/20 blur-[140px]"></div>
      </div>

      <div class="relative mx-auto flex min-h-screen max-w-6xl flex-col gap-12 px-6 py-12 lg:flex-row lg:items-center">
        <section class="flex-1 space-y-6">
          <div class="inline-flex items-center gap-2 rounded-full border border-white/10 bg-white/5 px-4 py-2 text-sm text-white/80">
            <span class="h-2 w-2 rounded-full bg-glow-400"></span>
            Plataforma de feedback inteligente
          </div>
          <h1 class="text-4xl font-semibold leading-tight md:text-5xl">
            ReviewPay centraliza decisões, feedbacks e operações em um painel simples.
          </h1>
          <p class="text-lg text-white/70">
            Acompanhe a evolução do seu SaaS com um painel moderno, rápido e feito para o dia a dia do time.
          </p>
          <div class="grid gap-4 md:grid-cols-2">
            <div class="rounded-2xl border border-white/10 bg-white/5 p-4">
              <h3 class="text-base font-medium">Seguro e confiável</h3>
              <p class="text-sm text-white/70">Autenticação simples e controle centralizado.</p>
            </div>
            <div class="rounded-2xl border border-white/10 bg-white/5 p-4">
              <h3 class="text-base font-medium">Rápido e elegante</h3>
              <p class="text-sm text-white/70">Interface limpa para operar sem distrações.</p>
            </div>
          </div>
          <div class="flex flex-wrap gap-3 text-xs text-white/60">
            <span class="rounded-full border border-white/10 px-3 py-1">Fluxo inteligente</span>
            <span class="rounded-full border border-white/10 px-3 py-1">Painel em tempo real</span>
            <span class="rounded-full border border-white/10 px-3 py-1">Operação contínua</span>
          </div>
        </section>

        <section class="flex w-full max-w-md flex-col gap-6 rounded-3xl border border-white/10 bg-ink-800/80 p-6 shadow-xl backdrop-blur">
          <div>
            <h2 class="text-2xl font-semibold">Acessar painel</h2>
            <p class="text-sm text-white/70">Digite a senha de acesso para entrar na plataforma.</p>
          </div>

          <form id="loginForm" class="grid gap-3">
            <h3 class="text-sm font-medium uppercase tracking-wide text-white/60">Acesso rápido</h3>
            <input
              class="w-full rounded-xl border border-white/10 bg-ink-700 px-4 py-3 text-sm text-white placeholder:text-white/40"
              type="password"
              name="password"
              placeholder=""
              required
            />
            <button
              class="rounded-xl border border-white/10 bg-white/5 px-4 py-3 text-sm font-semibold text-white transition hover:bg-white/10"
              type="submit"
            >
              Entrar
            </button>
          </form>

          <p id="authMessage" class="text-sm text-rose-400"></p>
        </section>
      </div>
    </div>
    <div id="appView" class="relative hidden min-h-screen bg-ink-900">
      <div class="pointer-events-none absolute inset-0 overflow-hidden">
        <div class="absolute -top-32 right-10 h-72 w-72 rounded-full bg-glow-600/15 blur-[130px]"></div>
        <div class="absolute bottom-0 left-0 h-80 w-80 rounded-full bg-glow-500/10 blur-[150px]"></div>
      </div>
      <div class="relative flex min-h-screen">
        <aside class="sidebar hidden flex-col border-r border-white/10 bg-ink-800/60 py-8 lg:flex">
          <div class="sidebar-logo flex items-center gap-3 px-2">
            <div class="flex h-11 w-11 items-center justify-center rounded-2xl bg-glow-500/80 text-ink-900">
              <span class="text-lg font-bold">R</span>
            </div>
            <div>
              <p class="sidebar-text text-lg font-semibold">ReviewPay</p>
              <p class="sidebar-text text-xs text-white/50">Central de feedback</p>
            </div>
          </div>
          <nav class="mt-6 flex flex-1 flex-col gap-1 text-sm">
            <button
              type="button"
              data-section-target="dashboard"
              class="nav-item flex items-center gap-3 rounded-xl bg-white/10 px-3 py-2 text-white transition"
            >
              <span class="flex h-8 w-8 items-center justify-center rounded-lg bg-white/5">
                <svg class="h-5 w-5 text-white/80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M3 10.5L12 3l9 7.5v9a1.5 1.5 0 01-1.5 1.5H4.5A1.5 1.5 0 013 19.5v-9z" />
                  <path stroke-linecap="round" stroke-linejoin="round" d="M9 21V12h6v9" />
                </svg>
              </span>
              <span class="sidebar-text">Principal</span>
            </button>
            <button
              type="button"
              data-section-target="reviews"
              class="nav-item flex items-center gap-3 rounded-xl px-3 py-2 text-white/60 transition hover:bg-white/5"
            >
              <span class="flex h-8 w-8 items-center justify-center rounded-lg bg-white/5">
                <svg class="h-5 w-5 text-white/80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M9 5h6a2 2 0 012 2v12a2 2 0 01-2 2H9a2 2 0 01-2-2V7a2 2 0 012-2z" />
                  <path stroke-linecap="round" stroke-linejoin="round" d="M9 5V3h6v2" />
                  <path stroke-linecap="round" stroke-linejoin="round" d="M8 11h8M8 15h5" />
                </svg>
              </span>
              <span class="sidebar-text">Avaliações</span>
            </button>
            <button
              type="button"
              data-section-target="financeiro"
              class="nav-item flex items-center gap-3 rounded-xl px-3 py-2 text-white/60 transition hover:bg-white/5"
            >
              <span class="flex h-8 w-8 items-center justify-center rounded-lg bg-white/5">
                <svg class="h-5 w-5 text-white/80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M12 3v18" />
                  <path stroke-linecap="round" stroke-linejoin="round" d="M16.5 7.5c0-1.933-1.79-3.5-4-3.5s-4 1.567-4 3.5 1.79 3.5 4 3.5 4 1.567 4 3.5-1.79 3.5-4 3.5-4-1.567-4-3.5" />
                </svg>
              </span>
              <span class="sidebar-text">Financeiro</span>
            </button>
            <button
              type="button"
              data-section-target="relatorios"
              class="nav-item flex items-center gap-3 rounded-xl px-3 py-2 text-white/60 transition hover:bg-white/5"
            >
              <span class="flex h-8 w-8 items-center justify-center rounded-lg bg-white/5">
                <svg class="h-5 w-5 text-white/80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M3 3v18h18" />
                  <path stroke-linecap="round" stroke-linejoin="round" d="M7 15l3-3 3 2 5-6" />
                </svg>
              </span>
              <span class="sidebar-text">Relatórios</span>
            </button>
            <button
              type="button"
              data-section-target="equipe"
              class="nav-item flex items-center gap-3 rounded-xl px-3 py-2 text-white/60 transition hover:bg-white/5"
            >
              <span class="flex h-8 w-8 items-center justify-center rounded-lg bg-white/5">
                <svg class="h-5 w-5 text-white/80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M16 11a4 4 0 10-8 0 4 4 0 008 0z" />
                  <path stroke-linecap="round" stroke-linejoin="round" d="M3 21a9 9 0 0118 0" />
                </svg>
              </span>
              <span class="sidebar-text">Equipe</span>
            </button>
            <button
              type="button"
              data-section-target="ferramentas"
              class="nav-item flex items-center gap-3 rounded-xl px-3 py-2 text-white/60 transition hover:bg-white/5"
            >
              <span class="flex h-8 w-8 items-center justify-center rounded-lg bg-white/5">
                <svg class="h-5 w-5 text-white/80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83" />
                  <circle cx="12" cy="12" r="3.5" stroke-linecap="round" stroke-linejoin="round"></circle>
                </svg>
              </span>
              <span class="sidebar-text">Ferramentas</span>
            </button>
            <button
              type="button"
              data-section-target="produtos"
              class="nav-item flex items-center gap-3 rounded-xl px-3 py-2 text-white/60 transition hover:bg-white/5"
            >
              <span class="flex h-8 w-8 items-center justify-center rounded-lg bg-white/5">
                <svg class="h-5 w-5 text-white/80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M4 7l8-4 8 4-8 4-8-4z" />
                  <path stroke-linecap="round" stroke-linejoin="round" d="M4 7v10l8 4 8-4V7" />
                </svg>
              </span>
              <span class="sidebar-text">Produtos</span>
            </button>
            <button
              type="button"
              data-section-target="integracoes"
              class="nav-item flex items-center gap-3 rounded-xl px-3 py-2 text-white/60 transition hover:bg-white/5"
            >
              <span class="flex h-8 w-8 items-center justify-center rounded-lg bg-white/5">
                <svg class="h-5 w-5 text-white/80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M10 14a4 4 0 010-8h3" />
                  <path stroke-linecap="round" stroke-linejoin="round" d="M14 10a4 4 0 010 8h-3" />
                </svg>
              </span>
              <span class="sidebar-text">Integrações</span>
            </button>
            <button
              type="button"
              data-section-target="videoaula"
              class="nav-item flex items-center gap-3 rounded-xl px-3 py-2 text-white/60 transition hover:bg-white/5"
            >
              <span class="flex h-8 w-8 items-center justify-center rounded-lg bg-white/5">
                <svg class="h-5 w-5 text-white/80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M4 5h16a2 2 0 012 2v10a2 2 0 01-2 2H4a2 2 0 01-2-2V7a2 2 0 012-2z" />
                  <path stroke-linecap="round" stroke-linejoin="round" d="M10 9l5 3-5 3V9z" />
                </svg>
              </span>
              <span class="sidebar-text">Vídeo aula</span>
            </button>
            <button
              type="button"
              data-section-target="suporte"
              class="nav-item flex items-center gap-3 rounded-xl px-3 py-2 text-white/60 transition hover:bg-white/5"
            >
              <span class="flex h-8 w-8 items-center justify-center rounded-lg bg-white/5">
                <svg class="h-5 w-5 text-white/80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M4 13v-2a8 8 0 0116 0v2" />
                  <path stroke-linecap="round" stroke-linejoin="round" d="M4 13a3 3 0 003 3h1v-6H7a3 3 0 00-3 3zM20 13a3 3 0 01-3 3h-1v-6h1a3 3 0 013 3z" />
                </svg>
              </span>
              <span class="sidebar-text">Suporte</span>
            </button>
          </nav>
        </aside>

        <div class="sidebar-hover-spacer hidden lg:block"></div>
        <main class="flex-1">
          <header class="flex flex-wrap items-center justify-between gap-4 border-b border-white/10 bg-gradient-to-r from-ink-800/90 via-ink-900/95 to-ink-800/90 px-6 py-6 backdrop-blur shadow-[0_20px_50px_-30px_rgba(15,23,42,0.8)]">
            <div>
              <h2 class="text-2xl font-semibold">Bem-vindo ao ReviewPay</h2>
            </div>
            <div class="flex flex-wrap items-center gap-3">
              <div class="plan-badge rounded-full border border-glow-500/40 bg-gradient-to-r from-glow-500/20 to-glow-600/20 px-4 py-2 text-xs font-semibold uppercase tracking-wide text-glow-400">
                Plano VIP BLACK
              </div>
              <div class="rounded-2xl border border-white/10 bg-ink-900/70 px-4 py-2">
                <div class="flex items-center justify-between gap-2">
                  <p class="text-xs text-white/60">Carteira</p>
                  <button
                    id="walletVisibilityToggle"
                    type="button"
                    class="flex h-7 w-7 items-center justify-center rounded-full border border-white/10 bg-white/5 text-white/60 transition hover:bg-white/10 hover:text-white"
                    aria-pressed="false"
                  >
                    <span id="walletVisibilityLabel" class="sr-only">Ocultar valores</span>
                    <svg
                      id="walletEyeOn"
                      xmlns="http://www.w3.org/2000/svg"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="1.5"
                      class="h-4 w-4"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        d="M2.458 12C3.732 7.943 7.523 5 12 5c4.477 0 8.268 2.943 9.542 7-1.274 4.057-5.065 7-9.542 7-4.477 0-8.268-2.943-9.542-7Z"
                      />
                      <circle cx="12" cy="12" r="3" />
                    </svg>
                    <svg
                      id="walletEyeOff"
                      xmlns="http://www.w3.org/2000/svg"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="1.5"
                      class="hidden h-4 w-4"
                    >
                      <path stroke-linecap="round" stroke-linejoin="round" d="M3 3l18 18" />
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        d="M10.5 6.5A8.9 8.9 0 0 1 12 6c4.477 0 8.268 2.943 9.542 7a12.6 12.6 0 0 1-2.64 4.15M6.25 6.25A12.6 12.6 0 0 0 2.458 12c1.274 4.057 5.065 7 9.542 7 1.7 0 3.3-.42 4.71-1.16"
                      />
                      <path stroke-linecap="round" stroke-linejoin="round" d="M9.9 9.9a3 3 0 0 0 4.2 4.2" />
                    </svg>
                  </button>
                </div>
                <p class="text-lg font-semibold" id="walletBalance">R$ 0,00</p>
              </div>
              <div class="rounded-2xl border border-white/10 bg-ink-900/70 px-4 py-2">
                <p class="text-xs text-white/60">Status</p>
                <p class="text-lg font-semibold" id="connectionStatus">Conectado</p>
              </div>
              <button
                id="logoutButton"
                class="rounded-xl border border-white/10 bg-white/5 px-4 py-2 text-sm font-medium text-white/80 transition hover:bg-white/10"
                type="button"
              >
                Sair
              </button>
            </div>
          </header>

          <div class="px-6 py-8">
            <section id="section-dashboard" data-section="dashboard" class="space-y-6">
              <div class="rounded-[32px] border border-white/10 bg-gradient-to-br from-ink-800/90 via-ink-900/95 to-ink-800/80 p-6 shadow-[0_25px_70px_-35px_rgba(56,189,248,0.6)]">
                <div class="flex flex-wrap items-center justify-between gap-3">
                  <div>
                    <h3 class="text-xl font-semibold">Central VIP BLACK</h3>
                    <p class="text-sm text-white/60">Operação premium com decisões rápidas e feedbacks confiáveis.</p>
                  </div>
                  <button class="rounded-full border border-white/10 bg-white/5 px-4 py-2 text-xs text-white/70 hover:bg-white/10">Falar com suporte</button>
                </div>
                <div class="mt-4 grid gap-3 md:grid-cols-3">
                  <div class="rounded-2xl border border-white/10 bg-white/5 p-4 backdrop-blur">
                    <p class="text-xs text-white/60">Status da operação</p>
                    <p class="text-lg font-semibold" id="modeText">Operação contínua</p>
                  </div>
                  <div class="rounded-2xl border border-white/10 bg-white/5 p-4 backdrop-blur">
                    <p class="text-xs text-white/60">Saldo disponível</p>
                    <p class="text-lg font-semibold" id="walletBalanceInline">R$ 0,00</p>
                  </div>
                  <div class="rounded-2xl border border-white/10 bg-white/5 p-4 backdrop-blur">
                    <p class="text-xs text-white/60">Avaliações ativas</p>
                    <p class="text-lg font-semibold" id="statActiveReviews">0</p>
                  </div>
                </div>
              </div>

              <div class="grid gap-6 lg:grid-cols-3">
                <section class="lg:col-span-2 space-y-6">
                  <div class="rounded-3xl border border-white/10 bg-white p-6 text-ink-900 shadow-lg">
                    <div class="flex flex-wrap items-center justify-between gap-3">
                      <h3 class="text-xl font-semibold">Centro de controle</h3>
                      <span class="rounded-full bg-emerald-100 px-3 py-1 text-xs font-semibold text-emerald-700">Operação</span>
                    </div>
                    <p class="mt-2 text-sm text-slate-600">
                      Seu painel central para manter o time alinhado e as decisões registradas com clareza.
                    </p>
                    <div class="mt-4 grid gap-3 md:grid-cols-2">
                      <div class="rounded-2xl border border-slate-100 bg-slate-50 p-4">
                        <p class="text-xs text-slate-500">Modo atual</p>
                        <p class="text-lg font-semibold">Operação contínua</p>
                      </div>
                      <div class="rounded-2xl border border-slate-100 bg-slate-50 p-4">
                        <p class="text-xs text-slate-500">Canal ativo</p>
                        <p class="text-lg font-semibold">Equipe interna</p>
                      </div>
                    </div>
                    <div class="mt-4 grid gap-3 md:grid-cols-4">
                      <div class="rounded-2xl border border-slate-100 bg-slate-50 p-4">
                        <p class="text-xs text-slate-500">Avaliações ativas</p>
                        <p class="text-lg font-semibold" id="statActiveReviewsMirror">0</p>
                      </div>
                      <div class="rounded-2xl border border-slate-100 bg-slate-50 p-4">
                        <p class="text-xs text-slate-500">Expiram em 5 min</p>
                        <p class="text-lg font-semibold" id="statExpiringReviews">0</p>
                      </div>
                      <div class="rounded-2xl border border-slate-100 bg-slate-50 p-4">
                        <p class="text-xs text-slate-500">Saldo pendente</p>
                        <p class="text-lg font-semibold" id="statPendingBalances">0</p>
                      </div>
                      <div class="rounded-2xl border border-slate-100 bg-slate-50 p-4">
                        <p class="text-xs text-slate-500">Saques pendentes</p>
                        <p class="text-lg font-semibold" id="statPendingWithdrawals">0</p>
                      </div>
                    </div>
                  </div>

                  <div class="rounded-3xl border border-white/10 bg-ink-800/70 p-6">
                    <div class="flex items-center justify-between">
                      <h3 class="text-lg font-semibold">Avaliações pendentes</h3>
                      <span class="text-sm text-white/60" id="nextReviewInfo">Próxima em --</span>
                    </div>
                    <p class="mt-2 text-xs text-white/50">Cada avaliação expira em cerca de 20 minutos.</p>
                    <ul id="reviewList" class="mt-4 grid gap-3 text-sm text-white/70"></ul>
                  </div>
                </section>

                <section class="flex flex-col gap-6">
                  <div class="rounded-3xl border border-white/10 bg-ink-800/70 p-6">
                    <h3 class="text-lg font-semibold">Ações rápidas</h3>
                    <p class="mt-1 text-sm text-white/60">Atalhos para acelerar sua operação.</p>
                    <div class="mt-4 grid gap-3 text-sm">
                      <button
                        id="quickSync"
                        class="rounded-2xl border border-white/10 bg-ink-700/60 px-4 py-3 text-left text-white/80 hover:bg-white/10"
                        type="button"
                      >
                        Sincronizar marketplaces agora
                      </button>
                      <button
                        id="quickGenerate"
                        class="rounded-2xl border border-white/10 bg-ink-700/60 px-4 py-3 text-left text-white/80 hover:bg-white/10"
                        type="button"
                      >
                        Gerar novas avaliações recomendadas
                      </button>
                      <button
                        id="quickSummary"
                        class="rounded-2xl border border-white/10 bg-ink-700/60 px-4 py-3 text-left text-white/80 hover:bg-white/10"
                        type="button"
                      >
                        Gerar resumo VIP do dia
                      </button>
                    </div>
                  </div>

                  <div class="rounded-3xl border border-white/10 bg-ink-800/70 p-6">
                    <h3 class="text-lg font-semibold">Alertas inteligentes</h3>
                    <p class="mt-1 text-sm text-white/60">Pontos de atenção e status crítico.</p>
                    <ul id="alertList" class="mt-4 grid gap-2 text-xs text-white/70"></ul>
                  </div>

                  <div class="rounded-3xl border border-white/10 bg-ink-800/70 p-6">
                    <h3 class="text-lg font-semibold">Marketplaces</h3>
                    <p class="mt-1 text-sm text-white/60">Conecte e gerencie suas plataformas de venda.</p>
                    <ul id="marketplaceList" class="mt-4 grid gap-3 text-sm text-white/70"></ul>
                  </div>

                  <div class="rounded-3xl border border-white/10 bg-ink-800/70 p-6">
                    <h3 class="text-lg font-semibold">Resumo VIP</h3>
                    <p class="mt-1 text-sm text-white/60">Acompanhe as metas premium da semana.</p>
                    <div class="mt-4 grid gap-3 text-sm text-white/70">
                      <div class="rounded-2xl border border-white/10 bg-ink-700/60 p-4">
                        <p class="text-xs text-white/50">Avaliações concluídas</p>
                        <p class="text-lg font-semibold" id="statCompletedReviews">0</p>
                      </div>
                      <div class="rounded-2xl border border-white/10 bg-ink-700/60 p-4">
                        <div class="flex items-center justify-between gap-2">
                          <div>
                            <p class="text-xs text-white/50">Bônus VIP</p>
                            <p class="text-lg font-semibold" id="vipBonusValue">R$ 0,00</p>
                          </div>
                          <button
                            id="vipBonusCashout"
                            class="rounded-full border border-glow-500/40 bg-glow-500/10 px-3 py-1 text-[10px] font-semibold text-glow-400 hover:bg-glow-500/20"
                            type="button"
                          >
                            Sacar bônus
                          </button>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="rounded-3xl border border-white/10 bg-ink-800/70 p-6">
                    <h3 class="text-lg font-semibold">Atividades recentes</h3>
                    <p class="mt-1 text-sm text-white/60">Últimas ações registradas na conta.</p>
                    <ul id="activityList" class="mt-4 grid gap-3 text-sm text-white/70"></ul>
                  </div>
                </section>
              </div>

              <div class="rounded-3xl border border-white/10 bg-ink-800/70 p-5">
                <div class="flex flex-wrap items-start justify-between gap-3">
                  <div>
                    <h3 class="text-lg font-semibold">Área de membros</h3>
                    <p class="mt-1 text-sm text-white/60">Atualizações da comunidade a cada 5 minutos.</p>
                  </div>
                  <div class="flex items-center gap-2">
                    <span id="memberPulseUpdated" class="text-xs text-white/60">Atualizado agora</span>
                    <button
                      id="memberPulseRefresh"
                      class="rounded-full border border-white/10 bg-white/5 px-3 py-1 text-xs font-semibold text-white/70 transition hover:bg-white/10"
                      type="button"
                    >
                      Atualizar agora
                    </button>
                  </div>
                </div>
                <div id="memberPulseSummary" class="mt-3 grid gap-2 md:grid-cols-4"></div>
                <ul id="memberPulseList" class="mt-3 grid gap-2 md:grid-cols-2"></ul>
              </div>
            </section>

            <section id="section-reviews" data-section="reviews" class="hidden space-y-6">
              <div class="rounded-3xl border border-white/10 bg-ink-800/70 p-6">
                <h3 class="text-xl font-semibold">Avaliações ativas</h3>
                <p class="mt-1 text-sm text-white/60">Gerencie todas as avaliações disponíveis.</p>
                <div class="mt-4">
                  <ul id="reviewListSecondary" class="grid gap-3 text-sm text-white/70"></ul>
                </div>
              </div>
            </section>

            <section id="section-financeiro" data-section="financeiro" class="hidden space-y-6">
              <div class="rounded-3xl border border-white/10 bg-ink-800/70 p-6">
                <h3 class="text-xl font-semibold">Painel financeiro</h3>
                <p class="mt-1 text-sm text-white/60">Controle seu saldo e aprovações internas.</p>
                <div class="mt-4 grid gap-3 md:grid-cols-3 xl:grid-cols-6">
                  <div class="rounded-2xl border border-white/10 bg-ink-700/60 p-4">
                    <p class="text-xs text-white/50">Saldo atual</p>
                    <p class="text-lg font-semibold" id="financeBalance">R$ 0,00</p>
                  </div>
                  <div class="rounded-2xl border border-white/10 bg-ink-700/60 p-4">
                    <p class="text-xs text-white/50">Disponível p/ saque</p>
                    <p class="text-lg font-semibold" id="financeAvailableBalance">R$ 0,00</p>
                  </div>
                  <div class="rounded-2xl border border-white/10 bg-ink-700/60 p-4">
                    <p class="text-xs text-white/50">Solicitações de saldo</p>
                    <p class="text-lg font-semibold" id="financePendingBalance">0</p>
                  </div>
                  <div class="rounded-2xl border border-white/10 bg-ink-700/60 p-4">
                    <p class="text-xs text-white/50">Saques pendentes</p>
                    <p class="text-lg font-semibold" id="financePendingWithdrawals">0</p>
                  </div>
                  <div class="rounded-2xl border border-white/10 bg-ink-700/60 p-4">
                    <p class="text-xs text-white/50">Saques aprovados</p>
                    <p class="text-lg font-semibold" id="financeApprovedWithdrawals">0</p>
                  </div>
                  <div class="rounded-2xl border border-white/10 bg-ink-700/60 p-4">
                    <p class="text-xs text-white/50">Saques rejeitados</p>
                    <p class="text-lg font-semibold" id="financeRejectedWithdrawals">0</p>
                  </div>
                </div>
                <div class="mt-6 grid gap-4 lg:grid-cols-2">
                  <section class="rounded-2xl border border-white/10 bg-ink-700/60 p-5">
                    <h4 class="text-base font-semibold">Solicitar saque</h4>
                    <p class="mt-1 text-xs text-white/60">Informe o valor que deseja sacar. A aprovação é feita no painel admin.</p>
                    <form id="userWithdrawalForm" class="mt-4 grid gap-3">
                      <input
                        id="userWithdrawalAmount"
                        class="w-full rounded-xl border border-white/10 bg-ink-800 px-4 py-3 text-sm text-white placeholder:text-white/40"
                        type="number"
                        min="0.01"
                        step="0.01"
                        placeholder="Valor do saque (R$)"
                        required
                      />
                      <input
                        id="userWithdrawalKey"
                        class="w-full rounded-xl border border-white/10 bg-ink-800 px-4 py-3 text-sm text-white placeholder:text-white/40"
                        type="password"
                        autocomplete="off"
                        placeholder="Chave PIX"
                        required
                      />
                      <button
                        class="rounded-xl border border-white/10 bg-white/5 px-4 py-3 text-sm font-semibold text-white transition hover:bg-white/10"
                        type="submit"
                      >
                        Solicitar saque
                      </button>
                    </form>
                    <p id="userWithdrawalMessage" class="mt-3 text-xs text-white/60"></p>
                  </section>
                  <section class="rounded-2xl border border-white/10 bg-ink-700/60 p-5">
                    <h4 class="text-base font-semibold">Status dos saques</h4>
                    <p class="mt-1 text-xs text-white/60">Acompanhe suas solicitações e o status.</p>
                    <ul id="financeWithdrawalList" class="mt-4 grid gap-2 text-xs text-white/70"></ul>
                  </section>
                </div>
                <div class="mt-6 rounded-2xl border border-white/10 bg-ink-700/60 p-5">
                  <h4 class="text-base font-semibold">Pagamentos pendentes de aprovação</h4>
                  <p class="mt-1 text-xs text-white/60">Recompensas de avaliações aguardando liberação.</p>
                  <ul id="financeBalanceRequestList" class="mt-4 grid gap-2 text-xs text-white/70"></ul>
                </div>
                <div class="mt-6 rounded-2xl border border-white/10 bg-ink-700/60 p-5">
                  <h4 class="text-base font-semibold">Relatório de ganhos</h4>
                  <p class="mt-1 text-xs text-white/60">Métricas financeiras de avaliações aprovadas.</p>
                  <div class="mt-4 grid gap-3 md:grid-cols-3">
                    <div class="rounded-2xl border border-white/10 bg-ink-800/70 p-4">
                      <p class="text-xs text-white/50">Hoje</p>
                      <p class="text-lg font-semibold" id="salesToday">R$ 0,00</p>
                    </div>
                    <div class="rounded-2xl border border-white/10 bg-ink-800/70 p-4">
                      <p class="text-xs text-white/50">Este mês</p>
                      <p class="text-lg font-semibold" id="salesMonth">R$ 0,00</p>
                    </div>
                    <div class="rounded-2xl border border-white/10 bg-ink-800/70 p-4">
                      <p class="text-xs text-white/50">Período personalizado</p>
                      <p class="text-lg font-semibold" id="salesCustom">R$ 0,00</p>
                    </div>
                  </div>
                  <div class="mt-4 grid gap-3 md:grid-cols-3">
                    <input
                      id="salesStartDate"
                      class="w-full rounded-xl border border-white/10 bg-ink-800 px-4 py-3 text-sm text-white"
                      type="date"
                    />
                    <input
                      id="salesEndDate"
                      class="w-full rounded-xl border border-white/10 bg-ink-800 px-4 py-3 text-sm text-white"
                      type="date"
                    />
                    <button
                      id="salesApply"
                      class="rounded-xl border border-white/10 bg-white/5 px-4 py-3 text-sm font-semibold text-white transition hover:bg-white/10"
                      type="button"
                    >
                      Aplicar filtro
                    </button>
                  </div>
                  <p id="salesRangeMessage" class="mt-3 text-xs text-white/60"></p>
                </div>
              </div>
            </section>

            <section id="section-relatorios" data-section="relatorios" class="hidden space-y-6">
              <div class="rounded-3xl border border-white/10 bg-ink-800/70 p-6">
                <h3 class="text-xl font-semibold">Relatórios inteligentes</h3>
                <p class="mt-1 text-sm text-white/60">Indicadores de desempenho e qualidade das avaliações.</p>
                <div class="mt-5 grid gap-3 md:grid-cols-2 xl:grid-cols-4">
                  <div class="rounded-2xl border border-white/10 bg-ink-700/60 p-4">
                    <p class="text-xs text-white/50">Nota média</p>
                    <p class="text-lg font-semibold" id="reportAverageRating">0.0</p>
                  </div>
                  <div class="rounded-2xl border border-white/10 bg-ink-700/60 p-4">
                    <p class="text-xs text-white/50">Taxa de aprovação</p>
                    <p class="text-lg font-semibold" id="reportApprovalRate">0%</p>
                  </div>
                  <div class="rounded-2xl border border-white/10 bg-ink-700/60 p-4">
                    <p class="text-xs text-white/50">Tempo médio de aprovação</p>
                    <p class="text-lg font-semibold" id="reportApprovalTime">--</p>
                  </div>
                  <div class="rounded-2xl border border-white/10 bg-ink-700/60 p-4">
                    <p class="text-xs text-white/50">Ganhos liberados</p>
                    <p class="text-lg font-semibold" id="reportApprovedValue">R$ 0,00</p>
                  </div>
                </div>
                <div class="mt-4 grid gap-3 md:grid-cols-2">
                  <div class="rounded-2xl border border-white/10 bg-ink-700/60 p-4">
                    <p class="text-xs text-white/50">Pagamentos pendentes</p>
                    <p class="text-lg font-semibold" id="reportPendingValue">R$ 0,00</p>
                  </div>
                  <div class="rounded-2xl border border-white/10 bg-ink-700/60 p-4">
                    <p class="text-xs text-white/50">Avaliações aprovadas</p>
                    <p class="text-lg font-semibold" id="reportApprovedReviews">0</p>
                  </div>
                </div>
                <div class="mt-6 rounded-2xl border border-white/10 bg-ink-700/60 p-5">
                  <div class="flex flex-wrap items-center justify-between gap-4">
                    <div>
                      <p class="text-xs text-white/50">Resultado do período</p>
                      <p class="text-2xl font-semibold" id="reportSalesValue">R$ 0,00</p>
                      <p id="reportRangeMessage" class="mt-1 text-xs text-white/50">Periodo: Ultimos 30 dias</p>
                    </div>
                    <div class="rounded-2xl border border-white/10 bg-ink-800/70 px-4 py-3">
                      <p class="text-xs text-white/50">Média por dia</p>
                      <p class="text-lg font-semibold" id="reportDailyAverage">R$ 0,00</p>
                    </div>
                  </div>
                  <div class="mt-4 grid gap-3 md:grid-cols-[240px]">
                    <div class="grid gap-2">
                      <label class="text-xs text-white/50" for="reportRangeSelect">Periodo</label>
                      <select
                        id="reportRangeSelect"
                        class="w-full rounded-xl border border-white/10 bg-ink-800 px-4 py-3 text-sm text-white"
                      >
                        <option value="today">Hoje</option>
                        <option value="last7">Ultimos 7 dias</option>
                        <option value="last15">Ultimos 15 dias</option>
                        <option value="last30" selected>Ultimos 30 dias</option>
                      </select>
                    </div>
                  </div>
                </div>
                <div class="mt-6 rounded-3xl border border-white/10 bg-ink-900/70 p-6">
                  <div class="flex items-center justify-between">
                    <h4 class="text-base font-semibold">Gráfico de resultados</h4>
                    <span id="reportChartLabel" class="text-xs text-white/50">Ultimos 30 dias</span>
                  </div>
                  <div class="mt-4">
                    <canvas id="reportChart" class="h-56 w-full"></canvas>
                  </div>
                </div>
              </div>
            </section>

            <section id="section-equipe" data-section="equipe" class="hidden space-y-6">
              <div class="rounded-3xl border border-white/10 bg-ink-800/70 p-6">
                <h3 class="text-xl font-semibold">Equipe & permissões</h3>
                <p class="mt-1 text-sm text-white/60">Gerencie membros da operação e níveis de acesso.</p>
                <div class="mt-5 grid gap-4 lg:grid-cols-2">
                  <section class="rounded-2xl border border-white/10 bg-ink-700/60 p-5">
                    <h4 class="text-base font-semibold">Adicionar membro</h4>
                    <form id="teamMemberForm" class="mt-4 grid gap-3">
                      <input
                        id="teamMemberName"
                        class="w-full rounded-xl border border-white/10 bg-ink-800 px-4 py-3 text-sm text-white placeholder:text-white/40"
                        type="text"
                        placeholder="Nome do membro"
                        required
                      />
                      <input
                        id="teamMemberRole"
                        class="w-full rounded-xl border border-white/10 bg-ink-800 px-4 py-3 text-sm text-white placeholder:text-white/40"
                        type="text"
                        placeholder="Cargo ou função"
                        required
                      />
                      <button
                        class="rounded-xl border border-white/10 bg-white/5 px-4 py-3 text-sm font-semibold text-white transition hover:bg-white/10"
                        type="submit"
                      >
                        Adicionar membro
                      </button>
                    </form>
                    <p id="teamMemberMessage" class="mt-3 text-xs text-white/60"></p>
                  </section>
                  <section class="rounded-2xl border border-white/10 bg-ink-700/60 p-5">
                    <h4 class="text-base font-semibold">Membros ativos</h4>
                    <ul id="teamMemberList" class="mt-4 grid gap-2 text-xs text-white/70"></ul>
                  </section>
                </div>
              </div>
            </section>

            <section id="section-ferramentas" data-section="ferramentas" class="hidden space-y-6">
              <div class="rounded-3xl border border-white/10 bg-ink-800/70 p-6">
                <h3 class="text-xl font-semibold">Ferramentas da conta</h3>
                <p class="mt-1 text-sm text-white/60">Configurações que deixam sua operação mais rápida.</p>
                <div class="mt-4 space-y-3">
                  <label class="flex items-center justify-between rounded-2xl border border-white/10 bg-ink-700/60 px-4 py-3 text-sm">
                    <span>Notificações internas</span>
                    <input id="prefNotifications" type="checkbox" class="h-4 w-4 accent-glow-400" />
                  </label>
                  <label class="flex items-center justify-between rounded-2xl border border-white/10 bg-ink-700/60 px-4 py-3 text-sm">
                    <span>Resumo diário</span>
                    <input id="prefSummary" type="checkbox" class="h-4 w-4 accent-glow-400" />
                  </label>
                  <label class="flex items-center justify-between rounded-2xl border border-white/10 bg-ink-700/60 px-4 py-3 text-sm">
                    <span>Modo compacto</span>
                    <input id="prefCompact" type="checkbox" class="h-4 w-4 accent-glow-400" />
                  </label>
                </div>
              </div>
            </section>

            <section id="section-produtos" data-section="produtos" class="hidden space-y-6">
              <div class="rounded-3xl border border-white/10 bg-ink-800/70 p-6">
                <h3 class="text-xl font-semibold">Produtos em destaque</h3>
                <p class="mt-1 text-sm text-white/60">Itens mais avaliados pelos usuários.</p>
                <ul id="productHighlights" class="mt-4 grid gap-3 text-sm text-white/70"></ul>
              </div>
            </section>

            <section id="section-integracoes" data-section="integracoes" class="hidden space-y-6">
              <div class="rounded-3xl border border-white/10 bg-ink-800/70 p-6">
                <h3 class="text-xl font-semibold">Integrações ativas</h3>
                <p class="mt-1 text-sm text-white/60">Gerencie as conexões com suas plataformas.</p>
                <ul id="marketplaceListSecondary" class="mt-4 grid gap-3 text-sm text-white/70"></ul>
              </div>
            </section>

            <section id="section-videoaula" data-section="videoaula" class="hidden space-y-6">
              <div class="rounded-3xl border border-white/10 bg-ink-800/70 p-6">
                <h3 class="text-xl font-semibold">Vídeo aula</h3>
                <p class="mt-1 text-sm text-white/60">Aprenda a operar o ReviewPay com eficiência.</p>
                <div class="mt-4 rounded-2xl border border-white/10 bg-ink-700/60 p-6 text-sm text-white/70">
                  Tutorial premium em preparação. Em breve você terá um passo a passo aqui.
                </div>
              </div>
            </section>

            <section id="section-suporte" data-section="suporte" class="hidden space-y-6">
              <div class="rounded-3xl border border-white/10 bg-ink-800/70 p-6">
                <h3 class="text-xl font-semibold">Suporte VIP BLACK</h3>
                <p class="mt-1 text-sm text-white/60">Fale diretamente com nosso time premium.</p>
                <div class="mt-4 rounded-2xl border border-white/10 bg-ink-700/60 p-6 text-sm text-white/70">
                  Canal prioritário ativo. Resposta média em até 5 minutos úteis.
                </div>
              </div>
            </section>
          </div>
        </main>
      </div>
    </div>
    <div id="reviewOverlay" class="fixed inset-0 z-40 hidden items-center justify-center bg-black/60 p-6 backdrop-blur">
      <div class="w-full max-w-xl rounded-3xl border border-white/10 bg-ink-800 p-6 shadow-2xl">
          <div class="flex items-start justify-between gap-4">
            <div>
              <h3 class="text-xl font-semibold">Enviar avaliação</h3>
              <p id="reviewProductInfo" class="text-sm text-white/60"></p>
            </div>
            <div class="flex flex-wrap items-center gap-2">
              <button
                id="reviewOpenProduct"
                class="rounded-xl border border-glow-500/40 bg-glow-500/10 px-3 py-2 text-xs font-semibold text-glow-400 transition hover:bg-glow-500/20"
                type="button"
              >
                Ver produto
              </button>
              <button
                id="reviewToggleTutorial"
                class="rounded-xl border border-white/10 bg-white/5 px-3 py-2 text-xs font-semibold text-white/80 transition hover:bg-white/10"
                type="button"
              >
                Tutorial
              </button>
              <button
                id="reviewCancel"
                class="rounded-xl border border-white/10 px-3 py-2 text-xs font-semibold text-white/80 transition hover:bg-white/10"
                type="button"
              >
                Fechar
              </button>
            </div>
          </div>
          <div class="mt-5 space-y-4">
          <div class="grid gap-3 md:grid-cols-2">
            <div>
              <label class="text-xs text-white/60">Nota geral</label>
              <div class="mt-2 flex flex-wrap gap-2">
                <label class="flex items-center gap-2 rounded-full border border-white/10 bg-ink-700 px-3 py-2 text-xs">
                  <input type="radio" name="reviewRating" value="5" class="accent-glow-400" />
                  5
                </label>
                <label class="flex items-center gap-2 rounded-full border border-white/10 bg-ink-700 px-3 py-2 text-xs">
                  <input type="radio" name="reviewRating" value="4" class="accent-glow-400" />
                  4
                </label>
                <label class="flex items-center gap-2 rounded-full border border-white/10 bg-ink-700 px-3 py-2 text-xs">
                  <input type="radio" name="reviewRating" value="3" class="accent-glow-400" />
                  3
                </label>
                <label class="flex items-center gap-2 rounded-full border border-white/10 bg-ink-700 px-3 py-2 text-xs">
                  <input type="radio" name="reviewRating" value="2" class="accent-glow-400" />
                  2
                </label>
                <label class="flex items-center gap-2 rounded-full border border-white/10 bg-ink-700 px-3 py-2 text-xs">
                  <input type="radio" name="reviewRating" value="1" class="accent-glow-400" />
                  1
                </label>
              </div>
            </div>
            <div>
              <label class="text-xs text-white/60">Recomendaria?</label>
              <select
                id="reviewRecommend"
                class="mt-2 w-full rounded-2xl border border-white/10 bg-ink-700 px-4 py-3 text-sm text-white"
              >
                <option value="">Selecione</option>
                <option value="sim">Sim</option>
                <option value="nao">Não</option>
              </select>
            </div>
          </div>

          <div>
            <label class="text-xs text-white/60">Qualidade do produto</label>
            <select
              id="reviewQuality"
              class="mt-2 w-full rounded-2xl border border-white/10 bg-ink-700 px-4 py-3 text-sm text-white"
            >
              <option value="">Selecione</option>
              <option value="excelente">Excelente</option>
              <option value="boa">Boa</option>
              <option value="regular">Regular</option>
              <option value="ruim">Ruim</option>
            </select>
          </div>

          <div>
            <label class="text-xs text-white/60">Nome do produto</label>
            <input
              id="reviewTitle"
              class="mt-2 w-full rounded-2xl border border-white/10 bg-ink-700 px-4 py-3 text-sm text-white placeholder:text-white/40"
              type="text"
              placeholder="Digite o nome do produto"
            />
          </div>

          <div>
            <label class="text-xs text-white/60">Código SKU</label>
            <input
              id="reviewSku"
              class="mt-2 w-full rounded-2xl border border-white/10 bg-ink-700 px-4 py-3 text-sm text-white placeholder:text-white/40"
              type="text"
              placeholder="Digite o SKU do anúncio"
            />
            <p class="mt-1 text-[11px] text-white/40">Confira o SKU em "Ver produto".</p>
          </div>

          <div>
            <label class="text-xs text-white/60">Seu feedback detalhado</label>
            <textarea
              id="reviewFeedback"
              class="mt-2 w-full rounded-2xl border border-white/10 bg-ink-700 px-4 py-3 text-sm text-white placeholder:text-white/40"
              rows="4"
              placeholder="Descreva o que achou do produto"
            ></textarea>
          </div>

          <button
            id="reviewSubmit"
            class="mt-2 w-full rounded-xl bg-glow-500 px-4 py-3 text-sm font-semibold text-ink-900 transition hover:bg-glow-400"
            type="button"
          >
            Enviar avaliação
          </button>
          <p id="reviewMessage" class="mt-3 text-xs text-white/60"></p>
        </div>
      </div>
    </div>
    <div id="reviewTutorialOverlay" class="fixed inset-0 z-40 hidden items-center justify-center bg-black/60 p-6 backdrop-blur">
      <div class="w-full max-w-lg rounded-3xl border border-white/10 bg-ink-800 p-6 shadow-2xl">
        <div class="flex items-start justify-between gap-4">
          <div>
            <h3 class="text-xl font-semibold">Passo a passo</h3>
            <p class="text-sm text-white/60">Como preencher a avaliação corretamente.</p>
          </div>
          <button
            id="reviewTutorialClose"
            class="rounded-xl border border-white/10 px-3 py-2 text-xs font-semibold text-white/80 transition hover:bg-white/10"
            type="button"
          >
            Fechar
          </button>
        </div>
        <ol class="mt-4 grid gap-3 text-sm text-white/70">
          <li>1. Clique em "Ver produto" e confira o anúncio real.</li>
          <li>2. Confirme nome, preço, categoria e especificações do item.</li>
          <li>3. Selecione a nota, recomendação e qualidade com base no anúncio.</li>
          <li>4. Digite o nome do produto e escreva um feedback claro.</li>
        </ol>
      </div>
    </div>
    <div id="productOverlay" class="fixed inset-0 z-50 hidden items-center justify-center bg-black/60 p-6 backdrop-blur">
      <div class="w-full max-w-2xl rounded-3xl border border-white/10 bg-ink-800 p-6 shadow-2xl">
        <div class="flex items-start justify-between gap-4">
          <div>
            <h3 id="productAdTitle" class="text-xl font-semibold">Anuncio do produto</h3>
            <p id="productAdMarketplace" class="text-sm text-white/60"></p>
          </div>
          <button
            id="productAdClose"
            class="rounded-xl border border-white/10 px-3 py-2 text-xs font-semibold text-white/80 transition hover:bg-white/10"
            type="button"
          >
            Fechar
          </button>
        </div>

        <div class="mt-6 grid gap-6 md:grid-cols-[220px,1fr]">
          <div class="flex h-56 items-center justify-center rounded-2xl border border-white/10 bg-gradient-to-br from-ink-700/80 to-ink-900/80 text-3xl font-semibold text-white/70">
            RP
          </div>
          <div class="space-y-4">
            <div class="flex flex-wrap items-center gap-3 text-sm">
              <span class="rounded-full border border-glow-500/40 bg-glow-500/10 px-3 py-1 text-xs text-glow-400">Anuncio VIP</span>
              <span class="rounded-full border border-white/10 px-3 py-1 text-xs text-white/60" id="productAdCategory"></span>
              <span class="rounded-full border border-white/10 px-3 py-1 text-xs text-white/60" id="productAdSku"></span>
            </div>
            <p id="productAdDescription" class="text-sm text-white/70"></p>
            <div class="rounded-2xl border border-white/10 bg-ink-900/60 p-4">
              <p class="text-xs font-semibold uppercase tracking-wide text-white/60">Especificações</p>
              <ul id="productAdSpecs" class="mt-2 grid gap-2 text-xs text-white/70"></ul>
            </div>
            <div class="flex items-center justify-between">
              <div>
                <p class="text-xs text-white/50">Preco</p>
                <p class="text-xl font-semibold" id="productAdPrice">R$ 0,00</p>
              </div>
              <button
                id="productAdExternal"
                class="rounded-xl border border-glow-500/40 bg-glow-500/10 px-4 py-2 text-xs font-semibold text-glow-400 transition hover:bg-glow-500/20"
                type="button"
              >
                Abrir anuncio real
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div id="toastContainer" class="fixed right-6 top-6 z-[60] flex max-w-sm flex-col gap-3"></div>

    <div id="adminOverlay" class="fixed inset-0 z-50 hidden items-center justify-center bg-black/60 p-6 backdrop-blur">
      <div class="w-full max-w-4xl max-h-[85vh] overflow-y-auto rounded-3xl border border-white/10 bg-ink-800 p-6 shadow-2xl">
        <div class="flex items-start justify-between gap-4">
          <div>
            <h3 class="text-xl font-semibold">Sub painel admin</h3>
            <p class="text-sm text-white/60">Controle operacional e aprovações críticas.</p>
          </div>
          <button
            id="adminClose"
            class="rounded-xl border border-white/10 px-3 py-2 text-xs font-semibold text-white/80 transition hover:bg-white/10"
            type="button"
          >
            Fechar
          </button>
        </div>

        <div class="mt-6 grid gap-4 lg:grid-cols-2">
          <section class="rounded-2xl border border-white/10 bg-ink-700/60 p-5">
            <h4 class="text-base font-semibold">Adicionar saldo</h4>
            <p class="mt-1 text-xs text-white/60">Aplicar saldo diretamente na sua conta.</p>
            <p class="mt-2 text-xs text-white/50">Saldo atual: <span id="adminBalanceValue">R$ 0,00</span></p>
            <form id="adminBalanceForm" class="mt-4 grid gap-3">
              <input
                id="adminBalanceAmount"
                class="w-full rounded-xl border border-white/10 bg-ink-700 px-4 py-3 text-sm text-white placeholder:text-white/40"
                type="number"
                min="0.01"
                step="0.01"
                placeholder="Valor do saldo"
                required
              />
              <button
                class="rounded-xl bg-glow-500 px-4 py-3 text-sm font-semibold text-ink-900 transition hover:bg-glow-400"
                type="submit"
              >
                Adicionar saldo
              </button>
            </form>
            <p id="adminBalanceMessage" class="mt-3 text-xs text-white/60"></p>
          </section>

          <section class="rounded-2xl border border-white/10 bg-ink-700/60 p-5">
            <h4 class="text-base font-semibold">Limpar saldo</h4>
            <p class="mt-1 text-xs text-white/60">Zera o saldo da carteira da conta atual.</p>
            <button
              id="adminClearBalance"
              class="mt-4 w-full rounded-xl border border-rose-400/40 bg-rose-500/10 px-4 py-3 text-sm font-semibold text-rose-200 transition hover:bg-rose-500/20"
              type="button"
            >
              Zerar saldo agora
            </button>
            <p id="adminClearMessage" class="mt-3 text-xs text-white/60"></p>
          </section>

          <section class="rounded-2xl border border-white/10 bg-ink-700/60 p-5">
            <h4 class="text-base font-semibold">Apagar tudo</h4>
            <p class="mt-1 text-xs text-white/60">Remove todas as avaliações, saldos e dados desta conta.</p>
            <button
              id="adminResetAccount"
              class="mt-4 w-full rounded-xl border border-rose-400/40 bg-rose-500/10 px-4 py-3 text-sm font-semibold text-rose-200 transition hover:bg-rose-500/20"
              type="button"
            >
              Apagar tudo agora
            </button>
            <p id="adminResetMessage" class="mt-3 text-xs text-white/60"></p>
          </section>

          <section class="rounded-2xl border border-white/10 bg-ink-700/60 p-5">
            <h4 class="text-base font-semibold">Adicionar avaliação</h4>
            <form id="adminReviewForm" class="mt-4 grid gap-3">
              <select
                id="adminMarketplace"
                class="w-full rounded-xl border border-white/10 bg-ink-700 px-4 py-3 text-sm text-white"
                required
              >
                <option value="">Selecione o marketplace</option>
                <option value="mercado_livre">Mercado Livre</option>
                <option value="shopee">Shopee</option>
                <option value="amazon">Amazon</option>
                <option value="magalu">Magazine Luiza</option>
                <option value="shein">Shein</option>
                <option value="aliexpress">AliExpress</option>
              </select>
              <input
                id="adminProductName"
                class="w-full rounded-xl border border-white/10 bg-ink-700 px-4 py-3 text-sm text-white"
                type="text"
                placeholder="Nome do produto"
                required
              />
              <input
                id="adminRewardValue"
                class="w-full rounded-xl border border-white/10 bg-ink-700 px-4 py-3 text-sm text-white"
                type="number"
                min="0.01"
                step="0.01"
                placeholder="Recompensa (R$)"
                required
              />
              <button
                class="rounded-xl border border-white/10 bg-white/5 px-4 py-3 text-sm font-semibold text-white transition hover:bg-white/10"
                type="submit"
              >
                Adicionar avaliação
              </button>
            </form>
            <ul id="adminReviewList" class="mt-4 grid gap-2 text-xs text-white/70"></ul>
          </section>

          <section class="rounded-2xl border border-white/10 bg-ink-700/60 p-5">
            <h4 class="text-base font-semibold">Adicionar saldo bônus</h4>
            <p class="mt-1 text-xs text-white/60">Aplique bônus manualmente para esta conta.</p>
            <p class="mt-2 text-xs text-white/50">Bônus atual: <span id="adminBonusValue">R$ 0,00</span></p>
            <form id="adminBonusForm" class="mt-4 grid gap-3">
              <input
                id="adminBonusAmount"
                class="w-full rounded-xl border border-white/10 bg-ink-700 px-4 py-3 text-sm text-white placeholder:text-white/40"
                type="number"
                min="0.01"
                step="0.01"
                placeholder="Valor do bônus"
                required
              />
              <button
                class="rounded-xl border border-white/10 bg-white/5 px-4 py-3 text-sm font-semibold text-white transition hover:bg-white/10"
                type="submit"
              >
                Adicionar bônus
              </button>
            </form>
            <p id="adminBonusMessage" class="mt-3 text-xs text-white/60"></p>
          </section>

          <section class="rounded-2xl border border-white/10 bg-ink-700/60 p-5">
            <h4 class="text-base font-semibold">Resultado 30 dias</h4>
            <p class="mt-1 text-xs text-white/60">Defina o total dos ultimos 30 dias. O sistema distribui automaticamente por dia.</p>
            <p class="mt-2 text-xs text-white/50">Total atual: <span id="adminRollingValue">R$ 0,00</span></p>
            <form id="adminRollingForm" class="mt-4 grid gap-3">
              <input
                id="adminRollingAmount"
                class="w-full rounded-xl border border-white/10 bg-ink-700 px-4 py-3 text-sm text-white"
                type="number"
                min="0"
                step="0.01"
                placeholder="Total dos ultimos 30 dias (R$)"
                required
              />
              <button
                class="rounded-xl border border-white/10 bg-white/5 px-4 py-3 text-sm font-semibold text-white transition hover:bg-white/10"
                type="submit"
              >
                Salvar total 30 dias
              </button>
            </form>
            <button
              id="adminRollingClear"
              class="mt-3 w-full rounded-xl border border-rose-400/40 bg-rose-500/10 px-4 py-2 text-xs font-semibold text-rose-200 transition hover:bg-rose-500/20"
              type="button"
            >
              Remover ajuste
            </button>
            <p id="adminRollingMessage" class="mt-3 text-xs text-white/60"></p>
          </section>

          <section class="rounded-2xl border border-white/10 bg-ink-700/60 p-5">
            <h4 class="text-base font-semibold">Aprovar saldos</h4>
            <form id="balanceRequestForm" class="mt-4 grid gap-3">
              <input
                id="balanceRequestLabel"
                class="w-full rounded-xl border border-white/10 bg-ink-700 px-4 py-3 text-sm text-white"
                type="text"
                placeholder="Solicitante / referência"
                required
              />
              <input
                id="balanceRequestAmount"
                class="w-full rounded-xl border border-white/10 bg-ink-700 px-4 py-3 text-sm text-white"
                type="number"
                min="0.01"
                step="0.01"
                placeholder="Valor solicitado"
                required
              />
              <button
                class="rounded-xl border border-white/10 bg-white/5 px-4 py-3 text-sm font-semibold text-white transition hover:bg-white/10"
                type="submit"
              >
                Registrar solicitação
              </button>
            </form>
            <ul id="balanceRequestList" class="mt-4 grid gap-2 text-xs text-white/70"></ul>
          </section>

          <section class="rounded-2xl border border-white/10 bg-ink-700/60 p-5 lg:col-span-2">
            <h4 class="text-base font-semibold">Aprovar saques</h4>
            <form id="withdrawalRequestForm" class="mt-4 grid gap-3 md:grid-cols-2">
              <input
                id="withdrawalRequestLabel"
                class="w-full rounded-xl border border-white/10 bg-ink-700 px-4 py-3 text-sm text-white"
                type="text"
                placeholder="Solicitante / referência"
                required
              />
              <input
                id="withdrawalRequestAmount"
                class="w-full rounded-xl border border-white/10 bg-ink-700 px-4 py-3 text-sm text-white"
                type="number"
                min="0.01"
                step="0.01"
                placeholder="Valor solicitado"
                required
              />
              <div class="md:col-span-2">
                <button
                  class="w-full rounded-xl border border-white/10 bg-white/5 px-4 py-3 text-sm font-semibold text-white transition hover:bg-white/10"
                  type="submit"
                >
                  Registrar solicitação de saque
                </button>
              </div>
            </form>
            <ul id="withdrawalRequestList" class="mt-4 grid gap-2 text-xs text-white/70"></ul>
          </section>
        </div>

        <p class="mt-4 text-xs text-white/50">Atalho: pressione 7 duas vezes rapidamente.</p>
      </div>
    </div>
    <script>
      const authView = document.getElementById('authView');
      const appView = document.getElementById('appView');
      const authMessage = document.getElementById('authMessage');
      const logoutButton = document.getElementById('logoutButton');
      const connectionStatus = document.getElementById('connectionStatus');
      const modeText = document.getElementById('modeText');
      const adminOverlay = document.getElementById('adminOverlay');
      const adminClose = document.getElementById('adminClose');
      const reviewOverlay = document.getElementById('reviewOverlay');
      const reviewCancel = document.getElementById('reviewCancel');
      const reviewSubmit = document.getElementById('reviewSubmit');
      const reviewFeedback = document.getElementById('reviewFeedback');
      const reviewProductInfo = document.getElementById('reviewProductInfo');
      const reviewMessage = document.getElementById('reviewMessage');
      const reviewOpenProduct = document.getElementById('reviewOpenProduct');
      const reviewToggleTutorial = document.getElementById('reviewToggleTutorial');
      const reviewTutorialOverlay = document.getElementById('reviewTutorialOverlay');
      const reviewTutorialClose = document.getElementById('reviewTutorialClose');
      const productOverlay = document.getElementById('productOverlay');
      const productAdTitle = document.getElementById('productAdTitle');
      const productAdMarketplace = document.getElementById('productAdMarketplace');
      const productAdCategory = document.getElementById('productAdCategory');
      const productAdSku = document.getElementById('productAdSku');
      const productAdDescription = document.getElementById('productAdDescription');
      const productAdSpecs = document.getElementById('productAdSpecs');
      const productAdPrice = document.getElementById('productAdPrice');
      const productAdExternal = document.getElementById('productAdExternal');
      const productAdClose = document.getElementById('productAdClose');
      const reviewRecommend = document.getElementById('reviewRecommend');
      const reviewQuality = document.getElementById('reviewQuality');
      const reviewTitle = document.getElementById('reviewTitle');
      const reviewSku = document.getElementById('reviewSku');
      const reviewRatingInputs = document.querySelectorAll('input[name="reviewRating"]');
      const prefNotifications = document.getElementById('prefNotifications');
      const prefSummary = document.getElementById('prefSummary');
      const prefCompact = document.getElementById('prefCompact');
      const reviewList = document.getElementById('reviewList');
      const reviewListSecondary = document.getElementById('reviewListSecondary');
      const nextReviewInfo = document.getElementById('nextReviewInfo');
      const statActiveReviews = document.getElementById('statActiveReviews');
      const statActiveReviewsMirror = document.getElementById('statActiveReviewsMirror');
      const statExpiringReviews = document.getElementById('statExpiringReviews');
      const statPendingBalances = document.getElementById('statPendingBalances');
      const statPendingWithdrawals = document.getElementById('statPendingWithdrawals');
      const statCompletedReviews = document.getElementById('statCompletedReviews');
      const marketplaceList = document.getElementById('marketplaceList');
      const marketplaceListSecondary = document.getElementById('marketplaceListSecondary');
      const walletBalance = document.getElementById('walletBalance');
      const walletBalanceInline = document.getElementById('walletBalanceInline');
      const walletVisibilityToggle = document.getElementById('walletVisibilityToggle');
      const walletVisibilityLabel = document.getElementById('walletVisibilityLabel');
      const walletEyeOn = document.getElementById('walletEyeOn');
      const walletEyeOff = document.getElementById('walletEyeOff');
      const financeBalance = document.getElementById('financeBalance');
      const financeAvailableBalance = document.getElementById('financeAvailableBalance');
      const financePendingBalance = document.getElementById('financePendingBalance');
      const financePendingWithdrawals = document.getElementById('financePendingWithdrawals');
      const financeApprovedWithdrawals = document.getElementById('financeApprovedWithdrawals');
      const financeRejectedWithdrawals = document.getElementById('financeRejectedWithdrawals');
      const financeBalanceRequestList = document.getElementById('financeBalanceRequestList');
      const financeWithdrawalList = document.getElementById('financeWithdrawalList');
      const userWithdrawalForm = document.getElementById('userWithdrawalForm');
      const userWithdrawalAmount = document.getElementById('userWithdrawalAmount');
      const userWithdrawalKey = document.getElementById('userWithdrawalKey');
      const userWithdrawalMessage = document.getElementById('userWithdrawalMessage');
      const salesToday = document.getElementById('salesToday');
      const salesMonth = document.getElementById('salesMonth');
      const salesCustom = document.getElementById('salesCustom');
      const salesStartDate = document.getElementById('salesStartDate');
      const salesEndDate = document.getElementById('salesEndDate');
      const salesApply = document.getElementById('salesApply');
      const salesRangeMessage = document.getElementById('salesRangeMessage');
      const productHighlights = document.getElementById('productHighlights');
      const activityList = document.getElementById('activityList');
      const alertList = document.getElementById('alertList');
      const memberPulseList = document.getElementById('memberPulseList');
      const memberPulseSummary = document.getElementById('memberPulseSummary');
      const memberPulseUpdated = document.getElementById('memberPulseUpdated');
      const memberPulseRefresh = document.getElementById('memberPulseRefresh');
      const quickSync = document.getElementById('quickSync');
      const quickGenerate = document.getElementById('quickGenerate');
      const quickSummary = document.getElementById('quickSummary');
      const toastContainer = document.getElementById('toastContainer');
      const reportAverageRating = document.getElementById('reportAverageRating');
      const reportApprovalRate = document.getElementById('reportApprovalRate');
      const reportApprovalTime = document.getElementById('reportApprovalTime');
      const reportApprovedValue = document.getElementById('reportApprovedValue');
      const reportPendingValue = document.getElementById('reportPendingValue');
      const reportApprovedReviews = document.getElementById('reportApprovedReviews');
      const reportSalesValue = document.getElementById('reportSalesValue');
      const reportDailyAverage = document.getElementById('reportDailyAverage');
      const reportRangeSelect = document.getElementById('reportRangeSelect');
      const reportCustomDateWrap = document.getElementById('reportCustomDateWrap');
      const reportCustomDate = document.getElementById('reportCustomDate');
      const reportRangeMessage = document.getElementById('reportRangeMessage');
      const reportChart = document.getElementById('reportChart');
      const reportChartLabel = document.getElementById('reportChartLabel');
      const teamMemberForm = document.getElementById('teamMemberForm');
      const teamMemberName = document.getElementById('teamMemberName');
      const teamMemberRole = document.getElementById('teamMemberRole');
      const teamMemberMessage = document.getElementById('teamMemberMessage');
      const teamMemberList = document.getElementById('teamMemberList');
      const vipBonusValue = document.getElementById('vipBonusValue');
      const vipBonusCashout = document.getElementById('vipBonusCashout');

      const adminBalanceForm = document.getElementById('adminBalanceForm');
      const adminBalanceAmount = document.getElementById('adminBalanceAmount');
      const adminBalanceMessage = document.getElementById('adminBalanceMessage');
      const adminBalanceValue = document.getElementById('adminBalanceValue');
      const adminClearBalance = document.getElementById('adminClearBalance');
      const adminClearMessage = document.getElementById('adminClearMessage');
      const adminResetAccount = document.getElementById('adminResetAccount');
      const adminResetMessage = document.getElementById('adminResetMessage');

      const adminReviewForm = document.getElementById('adminReviewForm');
      const adminMarketplace = document.getElementById('adminMarketplace');
      const adminProductName = document.getElementById('adminProductName');
      const adminRewardValue = document.getElementById('adminRewardValue');
      const adminReviewList = document.getElementById('adminReviewList');

      const adminBonusForm = document.getElementById('adminBonusForm');
      const adminBonusAmount = document.getElementById('adminBonusAmount');
      const adminBonusMessage = document.getElementById('adminBonusMessage');
      const adminBonusValue = document.getElementById('adminBonusValue');
      const adminRollingForm = document.getElementById('adminRollingForm');
      const adminRollingAmount = document.getElementById('adminRollingAmount');
      const adminRollingMessage = document.getElementById('adminRollingMessage');
      const adminRollingValue = document.getElementById('adminRollingValue');
      const adminRollingClear = document.getElementById('adminRollingClear');
      const adminReportForm = document.getElementById('adminReportForm');
      const adminReportDate = document.getElementById('adminReportDate');
      const adminReportAmount = document.getElementById('adminReportAmount');
      const adminReportMessage = document.getElementById('adminReportMessage');
      const adminReportList = document.getElementById('adminReportList');
      const adminReportMonthForm = document.getElementById('adminReportMonthForm');
      const adminReportMonth = document.getElementById('adminReportMonth');
      const adminReportMonthAmount = document.getElementById('adminReportMonthAmount');
      const adminReportMonthMessage = document.getElementById('adminReportMonthMessage');
      const adminReportMonthList = document.getElementById('adminReportMonthList');

      const balanceRequestForm = document.getElementById('balanceRequestForm');
      const balanceRequestLabel = document.getElementById('balanceRequestLabel');
      const balanceRequestAmount = document.getElementById('balanceRequestAmount');
      const balanceRequestList = document.getElementById('balanceRequestList');

      const withdrawalRequestForm = document.getElementById('withdrawalRequestForm');
      const withdrawalRequestLabel = document.getElementById('withdrawalRequestLabel');
      const withdrawalRequestAmount = document.getElementById('withdrawalRequestAmount');
      const withdrawalRequestList = document.getElementById('withdrawalRequestList');

      const accountStoragePrefix = 'reviewpay_account_v2_';
      let privacyMode = false;

      function safeStorageGet(key) {
        try {
          return localStorage.getItem(key);
        } catch (error) {
          return null;
        }
      }

      function safeStorageSet(key, value) {
        try {
          localStorage.setItem(key, value);
        } catch (error) {
          // ignore storage errors
        }
      }

      function safeStorageRemove(key) {
        try {
          localStorage.removeItem(key);
        } catch (error) {
          // ignore storage errors
        }
      }

      const privacyStorageKey = 'privacy_mode_v1';
      privacyMode = safeStorageGet(privacyStorageKey) === '1';

      function sanitizePixText(value) {
        const text = String(value ?? '');
        return text.replace(/(pix\s*:\s*)(.*)$/i, '$1PIX privado');
      }

      function maskSensitiveText(value) {
        const text = String(value ?? '');
        return text.replace(/\d/g, '•');
      }

      function applyPrivacyText(value) {
        const sanitized = sanitizePixText(value);
        return privacyMode ? maskSensitiveText(sanitized) : sanitized;
      }

      function setSensitiveValue(element, value) {
        if (!element) {
          return;
        }
        const text = String(value ?? '');
        element.dataset.sensitiveValue = text;
        element.textContent = applyPrivacyText(text);
      }

      function syncPrivacyVisibility() {
        const label = privacyMode ? 'Mostrar valores' : 'Ocultar valores';
        if (walletVisibilityLabel) {
          walletVisibilityLabel.textContent = label;
        }
        if (walletVisibilityToggle) {
          walletVisibilityToggle.setAttribute('aria-pressed', privacyMode ? 'true' : 'false');
          walletVisibilityToggle.setAttribute('title', label);
        }
        if (walletEyeOn) {
          walletEyeOn.classList.toggle('hidden', privacyMode);
        }
        if (walletEyeOff) {
          walletEyeOff.classList.toggle('hidden', !privacyMode);
        }

        const sensitiveElements = [
          walletBalance,
          walletBalanceInline,
          financeBalance,
          financeAvailableBalance,
          financePendingBalance,
          financePendingWithdrawals,
          financeApprovedWithdrawals,
          financeRejectedWithdrawals,
          salesToday,
          salesMonth,
          salesCustom,
          reportAverageRating,
          reportApprovalRate,
          reportApprovalTime,
          reportApprovedValue,
          reportPendingValue,
          reportApprovedReviews,
          reportSalesValue,
          reportDailyAverage,
          statActiveReviews,
          statActiveReviewsMirror,
          statExpiringReviews,
          statPendingBalances,
          statPendingWithdrawals,
          statCompletedReviews,
          vipBonusValue,
          adminBalanceValue,
          adminBonusValue,
          adminRollingValue,
          productAdPrice,
          reviewProductInfo
        ];

        sensitiveElements.forEach((element) => {
          if (!element) {
            return;
          }
          const stored = element.dataset.sensitiveValue ?? element.textContent ?? '';
          element.dataset.sensitiveValue = stored;
          element.textContent = applyPrivacyText(stored);
        });

        if (reportChart) {
          reportChart.classList.toggle('privacy-blur', privacyMode);
        }

        renderReviewList(true);
        renderAdminReviews();
        renderAdminReportList();
        renderAdminReportMonthList();
        renderFinanceLists();
        renderProductHighlights();
        renderMemberPulse();
        renderActivities();
        renderAlerts();

        if (accountState) {
          updateWalletBalance();
          updateDashboardStats();
          renderRequestList(accountState.balanceRequests || [], balanceRequestList, 'Sem solicitações de saldo.');
          renderRequestList(accountState.withdrawalRequests || [], withdrawalRequestList, 'Sem solicitações de saque.');
        }
      }

      const localAuthKey = 'local_auth_v1';
      const reviewIntervals = [3, 6, 9, 4, 7, 11];
      const reviewTTL = 20 * 60 * 1000;
      const navItems = document.querySelectorAll('[data-section-target]');
      const sections = document.querySelectorAll('[data-section]');
      let currentUser = null;
      let accountState = null;
      let lastSevenPress = 0;
      let taskTimer = null;
      let countdownTimer = null;
      let lastPendingReviewCount = 0;
      let lastZeroPress = 0;

      function showAuth() {
        appView.classList.add('hidden');
        authView.classList.remove('hidden');
      }

      function showApp() {
        authView.classList.add('hidden');
        appView.classList.remove('hidden');
        setActiveSection('dashboard');
      }

      function setActiveSection(sectionId) {
        if (!sectionId) {
          return;
        }
        sections.forEach((section) => {
          const isActive = section.dataset.section === sectionId;
          section.classList.toggle('hidden', !isActive);
        });
        navItems.forEach((item) => {
          const isActive = item.dataset.sectionTarget === sectionId;
          item.classList.toggle('bg-white/10', isActive);
          item.classList.toggle('text-white', isActive);
          if (isActive) {
            item.classList.remove('text-white/60');
          } else {
            item.classList.add('text-white/60');
          }
        });

        if (sectionId === 'relatorios') {
          updateReportSummary();
        }
      }

      function setUserInfo(user) {
        currentUser = user || { id: 'local-user' };
        const storageKey = `${accountStoragePrefix}${currentUser.id || 'default'}`;
        accountState = loadAccountState(storageKey);
        accountState.storageKey = storageKey;
        pruneExpiredReviews();
        seedInitialReviews();
        lastPendingReviewCount = accountState.reviews.filter((review) => review.status === 'pending').length;
        if (lastPendingReviewCount > 0) {
          notifyNewTask(lastPendingReviewCount);
        }
        updateWalletBalance();
        renderAllAdminLists();
        renderReviewList();
        renderMarketplaces();
        renderProductHighlights();
        initReportDates();
        initAdminReportDate();
        initAdminReportMonth();
        initSalesReport();
        updateDashboardStats();
        renderActivities();
        renderTeamMembers();
        scheduleNextReview();
        startCountdownTimer();
      }

      function setStatus(text) {
        connectionStatus.textContent = text;
      }

      function isLocalPasswordValid(value) {
        if (!value) {
          return false;
        }
        return String(value).trim().toLowerCase() === 'netosaas';
      }

      function openAdminOverlay() {
        if (appView.classList.contains('hidden')) {
          return;
        }
        initAdminReportDate();
        initAdminReportMonth();
        adminOverlay.classList.remove('hidden');
        adminOverlay.classList.add('flex');
      }

      function closeAdminOverlay() {
        adminOverlay.classList.add('hidden');
        adminOverlay.classList.remove('flex');
      }

      function toggleAdminOverlay() {
        if (adminOverlay.classList.contains('hidden')) {
          openAdminOverlay();
        } else {
          closeAdminOverlay();
        }
      }

      function loadPreference(element, key, defaultValue) {
        if (!element) {
          return;
        }
        const stored = safeStorageGet(key);
        if (stored === null) {
          element.checked = defaultValue;
        } else {
          element.checked = stored === 'true';
        }
      }

      function bindPreference(element, key) {
        if (!element) {
          return;
        }
        element.addEventListener('change', () => {
          safeStorageSet(key, element.checked ? 'true' : 'false');
        });
      }

      const marketplaceCatalog = [
        { id: 'mercado_livre', name: 'Mercado Livre' },
        { id: 'shopee', name: 'Shopee' },
        { id: 'amazon', name: 'Amazon' },
        { id: 'magalu', name: 'Magazine Luiza' },
        { id: 'shein', name: 'Shein' },
        { id: 'aliexpress', name: 'AliExpress' }
      ];

      const productCatalog = {
        mercado_livre: [
          'Smartphone Galaxy A15',
          'Fone JBL Tune 510',
          'Notebook Lenovo Ideapad',
          'Air Fryer Mondial 4L',
          'Caixa de Som JBL Go 3',
          'Cafeteira Espresso Oster',
          'Kit Teclado e Mouse Logitech',
          'Ferro de Passar Philips',
          'Aspirador Portatil WAP',
          'Monitor Samsung 24"'
        ],
        shopee: [
          'Tenis Esportivo Run X',
          'Relogio Digital Pulse',
          'Mouse Gamer Fire',
          'Luminaria LED Desk',
          'Camiseta Oversized Basic',
          'Cadeira Gamer Prime',
          'Mini Camera Wi-Fi',
          'Moletom Street Vintage',
          'Fone Bluetooth Duo',
          'Suporte de Celular Premium'
        ],
        amazon: [
          'Echo Dot 5',
          'Kindle 11a geracao',
          'Camera Logitech C920',
          'SSD Kingston 1TB',
          'Fire TV Stick 4K',
          'Monitor AOC 27"',
          'Mouse MX Master 3S',
          'Headset HyperX Cloud',
          'Roteador TP-Link AX1800',
          'Kindle Paperwhite'
        ],
        magalu: [
          'Cafeteira Arno',
          'Ventilador Turbo 40cm',
          'Smart TV 50"',
          'Liquidificador Philips',
          'Geladeira Brastemp Inverter',
          'Micro-ondas 32L',
          'Fogao 4 bocas Atlas',
          'Sanduicheira Grill',
          'Fritadeira Sem Oleo 5L',
          'Notebook Acer Aspire 5'
        ],
        shein: [
          'Jaqueta Puffer Slim',
          'Conjunto Fitness',
          'Bolsa Casual Trend',
          'Tenis Street',
          'Vestido Midi Elegance',
          'Blusa Tricot Soft',
          'Calca Cargo Street',
          'Mochila Minimal',
          'Top Seamless',
          'Shorts Jeans High'
        ],
        aliexpress: [
          'Teclado Mecanico 60%',
          'Drone Mini Cam',
          'Fone TWS Pro',
          'Carregador 65W GaN',
          'Smartwatch AMOLED X8',
          'Mini Projetor HD',
          'Webcam USB 1080p',
          'Bateria Externa 20000mAh',
          'Kit Lampadas RGB',
          'Controle Bluetooth Mobile'
        ]
      };

      function defaultMarketplaces() {
        return marketplaceCatalog.map((item, index) => ({
          id: item.id,
          name: item.name,
          connected: true,
          lastSync: new Date().toISOString()
        }));
      }

      function defaultAccountState() {
        return {
          balance: 0,
          bonusBalance: 0,
          walletCredits: [],
          bonusHistory: [],
          reviews: [],
          rewards: [],
          balanceRequests: [],
          withdrawalRequests: [],
          manualSales: [],
          manualSalesMonths: [],
          manualRollingSales: null,
          lastManualSaleDate: null,
          marketplaces: defaultMarketplaces(),
          activities: [],
          teamMembers: [
            { id: 'tm-1', name: 'Neto (Owner)', role: 'Administrador', status: 'ativo' },
            { id: 'tm-2', name: 'Equipe VIP', role: 'Operacao', status: 'ativo' }
          ],
          nextReviewAt: 0,
          reviewIntervalIndex: 0
        };
      }

      function seedInitialReviews() {
        if (!accountState) {
          return;
        }
        const pending = accountState.reviews.filter((review) => review.status === 'pending');
        if (pending.length > 0) {
          return;
        }
        const seedCount = 5;
        for (let i = 0; i < seedCount; i += 1) {
          const template = getRandomReviewTemplate();
          if (!template) {
            break;
          }
          accountState.reviews.unshift(createReviewItem(template, 'auto'));
        }
        const interval = reviewIntervals[accountState.reviewIntervalIndex % reviewIntervals.length];
        accountState.reviewIntervalIndex = (accountState.reviewIntervalIndex + 1) % reviewIntervals.length;
        accountState.nextReviewAt = Date.now() + interval * 60 * 1000;
        saveAccountState();
      }

      function loadAccountState(storageKey) {
        const fallback = defaultAccountState();
        if (!storageKey) {
          return fallback;
        }
        try {
          const stored = safeStorageGet(storageKey);
          if (!stored) {
            return { ...fallback };
          }
          const parsed = JSON.parse(stored);
          return {
            ...fallback,
            ...parsed,
            bonusBalance: Number(parsed.bonusBalance || 0),
            walletCredits: Array.isArray(parsed.walletCredits) ? parsed.walletCredits : [],
            bonusHistory: Array.isArray(parsed.bonusHistory) ? parsed.bonusHistory : [],
            reviews: Array.isArray(parsed.reviews) ? parsed.reviews : [],
            rewards: Array.isArray(parsed.rewards) ? parsed.rewards : [],
            balanceRequests: Array.isArray(parsed.balanceRequests) ? parsed.balanceRequests : [],
            withdrawalRequests: Array.isArray(parsed.withdrawalRequests) ? parsed.withdrawalRequests : [],
            manualSales: Array.isArray(parsed.manualSales) ? parsed.manualSales : [],
            manualSalesMonths: Array.isArray(parsed.manualSalesMonths) ? parsed.manualSalesMonths : [],
            manualRollingSales: parsed.manualRollingSales || null,
            lastManualSaleDate: parsed.lastManualSaleDate || null,
            marketplaces: Array.isArray(parsed.marketplaces) ? parsed.marketplaces : fallback.marketplaces,
            activities: Array.isArray(parsed.activities) ? parsed.activities : [],
            teamMembers: Array.isArray(parsed.teamMembers) ? parsed.teamMembers : fallback.teamMembers
          };
        } catch (error) {
          return { ...fallback };
        }
      }

      function saveAccountState() {
        if (!accountState || !accountState.storageKey) {
          return;
        }
        safeStorageSet(accountState.storageKey, JSON.stringify(accountState));
      }

      function roundCurrency(value) {
        return Math.round(value * 100) / 100;
      }

      function recordWalletCredit(amount, source = 'wallet', label = 'Crédito') {
        if (!accountState) {
          return;
        }
        const value = Number(amount || 0);
        if (Number.isNaN(value) || value <= 0) {
          return;
        }
        const entry = {
          id: `credit-${Date.now()}-${Math.random().toString(16).slice(2, 6)}`,
          amount: roundCurrency(value),
          source,
          label,
          createdAt: Date.now()
        };
        accountState.walletCredits = [entry, ...(accountState.walletCredits || [])].slice(0, 200);
      }

      function recordBonusEarned(amount, source = 'review', label = 'Bônus VIP', reviewId = null) {
        if (!accountState) {
          return;
        }
        const value = Number(amount || 0);
        if (Number.isNaN(value) || value <= 0) {
          return;
        }
        if (!Array.isArray(accountState.bonusHistory)) {
          accountState.bonusHistory = [];
        }
        const entry = {
          id: `bonus-${Date.now()}-${Math.random().toString(16).slice(2, 6)}`,
          amount: roundCurrency(value),
          source,
          label,
          reviewId: reviewId || null,
          createdAt: Date.now()
        };
        accountState.bonusHistory = [entry, ...accountState.bonusHistory].slice(0, 200);
      }

      const currencyFormatter = new Intl.NumberFormat('pt-BR', {
        style: 'currency',
        currency: 'BRL'
      });

      function formatCurrency(value) {
        const numberValue = Number(value || 0);
        return currencyFormatter.format(Number.isNaN(numberValue) ? 0 : numberValue);
      }

      function formatDateInput(date) {
        return date.toISOString().slice(0, 10);
      }

      function parseDateInput(value, isEnd = false) {
        if (!value) {
          return null;
        }
        const [year, month, day] = value.split('-').map(Number);
        if (!year || !month || !day) {
          return null;
        }
        return new Date(year, month - 1, day, isEnd ? 23 : 0, isEnd ? 59 : 0, isEnd ? 59 : 0, 999);
      }

      function formatMoney(value) {
        const numberValue = Number(value || 0);
        return numberValue.toFixed(2);
      }

      function parseAmount(value) {
        const parsed = Number(String(value).replace(',', '.'));
        if (Number.isNaN(parsed) || parsed <= 0) {
          return null;
        }
        return parsed;
      }

      function parseAmountAllowZero(value) {
        const parsed = Number(String(value).replace(',', '.'));
        if (Number.isNaN(parsed) || parsed < 0) {
          return null;
        }
        return parsed;
      }

      function parseDateKey(value) {
        if (!value) {
          return null;
        }
        const [year, month, day] = String(value).split('-').map(Number);
        if (!year || !month || !day) {
          return null;
        }
        return new Date(year, month - 1, day, 0, 0, 0);
      }

      function getPendingWithdrawalTotal() {
        if (!accountState) {
          return 0;
        }
        return (accountState.withdrawalRequests || [])
          .filter((request) => request.status === 'pendente')
          .reduce((total, request) => total + Number(request.amount || 0), 0);
      }

      function getAvailableBalance() {
        const balance = accountState ? Number(accountState.balance || 0) : 0;
        return Math.max(0, balance - getPendingWithdrawalTotal());
      }

      function getApprovedSales() {
        if (!accountState) {
          return [];
        }
        const approvedReviews = (accountState.balanceRequests || [])
          .filter((request) => request.status === 'aprovado' && request.source === 'review')
          .map((request) => {
            const timestamp = request.approvedAt || request.createdAt || null;
            return {
              amount: Number(request.amount || 0),
              date: timestamp ? new Date(timestamp) : null
            };
          })
          .filter((item) => item.date && !Number.isNaN(item.date.getTime()) && Number.isFinite(item.amount));

        const walletCredits = (accountState.walletCredits || [])
          .map((entry) => {
            const timestamp = entry.createdAt || entry.approvedAt || null;
            return {
              amount: Number(entry.amount || 0),
              date: timestamp ? new Date(timestamp) : null
            };
          })
          .filter((item) => item.date && !Number.isNaN(item.date.getTime()) && Number.isFinite(item.amount));

        return [...approvedReviews, ...walletCredits];
      }

      function getManualSalesMap() {
        if (!accountState || !Array.isArray(accountState.manualSales)) {
          return new Map();
        }
        const map = new Map();
        accountState.manualSales.forEach((entry) => {
          if (!entry || !entry.date) {
            return;
          }
          const value = Number(entry.value || 0);
          if (Number.isNaN(value)) {
            return;
          }
          map.set(entry.date, value);
        });
        return map;
      }

      function getManualMonthlyEntries() {
        if (!accountState || !Array.isArray(accountState.manualSalesMonths)) {
          return [];
        }
        return accountState.manualSalesMonths.filter((entry) => entry && entry.month && !Number.isNaN(Number(entry.value)));
      }

      function getRollingOverride() {
        if (!accountState || !accountState.manualRollingSales) {
          return null;
        }
        const total = Number(accountState.manualRollingSales.total);
        if (Number.isNaN(total)) {
          return null;
        }
        const now = new Date();
        const end = new Date(now.getFullYear(), now.getMonth(), now.getDate(), 23, 59, 59, 999);
        const start = new Date(end);
        start.setDate(end.getDate() - 29);
        start.setHours(0, 0, 0, 0);
        return {
          total,
          daily: total / 30,
          start,
          end
        };
      }

      function getDaysInMonth(year, monthIndex) {
        return new Date(year, monthIndex + 1, 0).getDate();
      }

      function applyMonthlyOverrides(totals, start, end) {
        const months = getManualMonthlyEntries();
        months.forEach((entry) => {
          const parts = String(entry.month).split('-').map(Number);
          if (parts.length < 2) {
            return;
          }
          const year = parts[0];
          const month = parts[1];
          if (!year || !month) {
            return;
          }
          const daysInMonth = getDaysInMonth(year, month - 1);
          const dailyValue = Number(entry.value || 0) / daysInMonth;
          for (let day = 1; day <= daysInMonth; day += 1) {
            const date = new Date(year, month - 1, day, 0, 0, 0);
            if (date < start || date > end) {
              continue;
            }
            const key = date.toISOString().slice(0, 10);
            totals.set(key, dailyValue);
          }
        });
      }

      function sumSalesBetween(start, end) {
        const rolling = getRollingOverride();
        if (rolling) {
          const overlapStart = start > rolling.start ? start : rolling.start;
          const overlapEnd = end < rolling.end ? end : rolling.end;
          let total = 0;
          if (overlapStart <= overlapEnd) {
            const days = daysBetweenInclusive(overlapStart, overlapEnd);
            total += rolling.daily * days;
          }
          const sales = getApprovedSales();
          sales.forEach((sale) => {
            if (sale.date < start || sale.date > end) {
              return;
            }
            if (sale.date >= rolling.start && sale.date <= rolling.end) {
              return;
            }
            total += sale.amount;
          });
          return total;
        }
        const sales = getApprovedSales();
        const totals = new Map();

        sales.forEach((sale) => {
          if (sale.date < start || sale.date > end) {
            return;
          }
          const key = sale.date.toISOString().slice(0, 10);
          totals.set(key, (totals.get(key) || 0) + sale.amount);
        });

        applyMonthlyOverrides(totals, start, end);

        const manualMap = getManualSalesMap();
        manualMap.forEach((value, key) => {
          const date = parseDateKey(key);
          if (!date || date < start || date > end) {
            return;
          }
          totals.set(key, value);
        });

        let total = 0;
        totals.forEach((value) => {
          total += value;
        });
        return total;
      }

      function sumBonusEarnedBetween(start, end) {
        if (!accountState) {
          return 0;
        }
        const startTime = start instanceof Date ? start.getTime() : 0;
        const endTime = end instanceof Date ? end.getTime() : Date.now();
        const history = Array.isArray(accountState.bonusHistory) ? accountState.bonusHistory : [];
        let total = 0;
        const historyReviewIds = new Set();

        history.forEach((entry) => {
          if (!entry) {
            return;
          }
          if (entry.reviewId) {
            historyReviewIds.add(String(entry.reviewId));
          }
          const timestamp = entry.createdAt;
          const timeValue = typeof timestamp === 'string' ? Date.parse(timestamp) : Number(timestamp);
          if (!Number.isFinite(timeValue) || timeValue < startTime || timeValue > endTime) {
            return;
          }
          const amount = Number(entry.amount || 0);
          if (Number.isNaN(amount)) {
            return;
          }
          total += amount;
        });

        const reviewTotal = (accountState.reviews || []).reduce((sum, review) => {
          if (!review || review.bonusEarned === undefined || review.bonusEarned === null) {
            return sum;
          }
          if (review.id && historyReviewIds.has(String(review.id))) {
            return sum;
          }
          const completedAt = Number(review.completedAt || review.approvedAt || 0);
          if (!Number.isFinite(completedAt) || completedAt < startTime || completedAt > endTime) {
            return sum;
          }
          const amount = Number(review.bonusEarned || 0);
          if (Number.isNaN(amount)) {
            return sum;
          }
          return sum + amount;
        }, 0);

        return roundCurrency(total + reviewTotal);
      }

      function updateSalesReport() {
        if (!salesToday || !salesMonth || !salesCustom) {
          return;
        }
        const now = new Date();
        const startToday = new Date(now.getFullYear(), now.getMonth(), now.getDate(), 0, 0, 0);
        const endToday = new Date(now.getFullYear(), now.getMonth(), now.getDate(), 23, 59, 59, 999);
        const startMonth = new Date(now.getFullYear(), now.getMonth(), 1, 0, 0, 0);
        const endMonth = new Date(now.getFullYear(), now.getMonth() + 1, 0, 23, 59, 59, 999);

        setSensitiveValue(salesToday, formatCurrency(sumSalesBetween(startToday, endToday)));
        setSensitiveValue(salesMonth, formatCurrency(sumSalesBetween(startMonth, endMonth)));

        const start = parseDateInput(salesStartDate?.value);
        const end = parseDateInput(salesEndDate?.value, true);
        if (start && end && start <= end) {
          setSensitiveValue(salesCustom, formatCurrency(sumSalesBetween(start, end)));
          if (salesRangeMessage) {
            salesRangeMessage.textContent = `Periodo: ${start.toLocaleDateString('pt-BR')} até ${end.toLocaleDateString('pt-BR')}.`;
          }
        } else {
          setSensitiveValue(salesCustom, 'R$ 0,00');
          if (salesRangeMessage) {
            salesRangeMessage.textContent = 'Selecione um periodo valido.';
          }
        }
      }

      function daysBetweenInclusive(start, end) {
        const startDate = new Date(start.getFullYear(), start.getMonth(), start.getDate());
        const endDate = new Date(end.getFullYear(), end.getMonth(), end.getDate());
        const diff = Math.round((endDate - startDate) / 86400000) + 1;
        return Math.max(1, diff);
      }

      function getSalesByDay(days, endDate = new Date()) {
        const end = new Date(endDate.getFullYear(), endDate.getMonth(), endDate.getDate(), 23, 59, 59, 999);
        const start = new Date(end);
        start.setDate(end.getDate() - (days - 1));
        start.setHours(0, 0, 0, 0);

        const buckets = new Map();
        for (let i = 0; i < days; i += 1) {
          const current = new Date(start);
          current.setDate(start.getDate() + i);
          const key = current.toISOString().slice(0, 10);
          buckets.set(key, { date: current, value: 0 });
        }

        const sales = getApprovedSales();
        sales.forEach((sale) => {
          if (sale.date < start || sale.date > end) {
            return;
          }
          const key = sale.date.toISOString().slice(0, 10);
          if (buckets.has(key)) {
            buckets.get(key).value += sale.amount;
          }
        });

        const rolling = getRollingOverride();
        if (rolling) {
          buckets.forEach((entry) => {
            if (entry.date >= rolling.start && entry.date <= rolling.end) {
              entry.value = rolling.daily;
            }
          });
        } else {
          const monthlyTotals = new Map();
          buckets.forEach((entry, key) => {
            monthlyTotals.set(key, entry.value);
          });
          applyMonthlyOverrides(monthlyTotals, start, end);
          monthlyTotals.forEach((value, key) => {
            if (buckets.has(key)) {
              buckets.get(key).value = value;
            }
          });

          const manualMap = getManualSalesMap();
          manualMap.forEach((value, key) => {
            if (buckets.has(key)) {
              buckets.get(key).value = value;
            }
          });
        }

        const labels = [];
        const values = [];
        buckets.forEach((entry) => {
          labels.push(entry.date.toLocaleDateString('pt-BR', { day: '2-digit', month: '2-digit' }));
          values.push(entry.value);
        });

        return { labels, values };
      }

      function renderReportChart(days = 30, endDate = new Date()) {
        if (!reportChart) {
          return;
        }
        const ctx = reportChart.getContext('2d');
        if (!ctx) {
          return;
        }
        const width = reportChart.clientWidth || 600;
        const height = reportChart.clientHeight || 220;
        const dpr = window.devicePixelRatio || 1;
        reportChart.width = width * dpr;
        reportChart.height = height * dpr;
        ctx.scale(dpr, dpr);

        ctx.clearRect(0, 0, width, height);
        ctx.fillStyle = 'rgba(15, 23, 42, 0.55)';
        ctx.fillRect(0, 0, width, height);

        const padding = 24;
        const chartWidth = width - padding * 2;
        const chartHeight = height - padding * 2;

        const { values } = getSalesByDay(days, endDate);
        const maxValue = Math.max(...values, 1);

        ctx.strokeStyle = 'rgba(148,163,184,0.2)';
        ctx.lineWidth = 1;
        for (let i = 0; i <= 4; i += 1) {
          const y = padding + (chartHeight / 4) * i;
          ctx.beginPath();
          ctx.moveTo(padding, y);
          ctx.lineTo(width - padding, y);
          ctx.stroke();
        }

        const step = chartWidth / (values.length - 1 || 1);
        const points = values.map((value, index) => {
          const x = padding + step * index;
          const y = padding + (1 - value / maxValue) * chartHeight;
          return { x, y };
        });

        const gradient = ctx.createLinearGradient(0, padding, 0, height - padding);
        gradient.addColorStop(0, 'rgba(56,189,248,0.5)');
        gradient.addColorStop(1, 'rgba(56,189,248,0)');

        ctx.beginPath();
        points.forEach((point, index) => {
          if (index === 0) {
            ctx.moveTo(point.x, point.y);
          } else {
            ctx.lineTo(point.x, point.y);
          }
        });
        ctx.lineTo(points[points.length - 1].x, height - padding);
        ctx.lineTo(points[0].x, height - padding);
        ctx.closePath();
        ctx.fillStyle = gradient;
        ctx.fill();

        ctx.beginPath();
        points.forEach((point, index) => {
          if (index === 0) {
            ctx.moveTo(point.x, point.y);
          } else {
            ctx.lineTo(point.x, point.y);
          }
        });
        ctx.strokeStyle = 'rgba(56,189,248,0.9)';
        ctx.lineWidth = 2;
        ctx.shadowColor = 'rgba(56,189,248,0.4)';
        ctx.shadowBlur = 6;
        ctx.stroke();
        ctx.shadowBlur = 0;
      }

      function updateReportSummary() {
        if (!reportSalesValue || !reportDailyAverage || !reportRangeSelect) {
          return;
        }

        const now = new Date();
        const endToday = new Date(now.getFullYear(), now.getMonth(), now.getDate(), 23, 59, 59, 999);
        let start = new Date(now.getFullYear(), now.getMonth(), now.getDate(), 0, 0, 0);
        let days = 1;
        let rangeLabel = 'Hoje';

        const selection = reportRangeSelect.value || 'today';

        if (selection === 'last7') {
          start = new Date(endToday);
          start.setDate(endToday.getDate() - 6);
          start.setHours(0, 0, 0, 0);
          days = 7;
          rangeLabel = 'Ultimos 7 dias';
        } else if (selection === 'last15') {
          start = new Date(endToday);
          start.setDate(endToday.getDate() - 14);
          start.setHours(0, 0, 0, 0);
          days = 15;
          rangeLabel = 'Ultimos 15 dias';
        } else if (selection === 'last30') {
          start = new Date(endToday);
          start.setDate(endToday.getDate() - 29);
          start.setHours(0, 0, 0, 0);
          days = 30;
          rangeLabel = 'Ultimos 30 dias';
        }

        const total = sumSalesBetween(start, endToday);
        setSensitiveValue(reportSalesValue, formatCurrency(total));
        setSensitiveValue(reportDailyAverage, formatCurrency(total / days));
        if (reportRangeMessage) {
          reportRangeMessage.textContent = `Periodo: ${rangeLabel}`;
        }
        if (reportChartLabel) {
          reportChartLabel.textContent = rangeLabel;
        }
        renderReportChart(Math.min(days, 60), endToday);
      }

      function initReportDates() {
        if (!reportCustomDate) {
          return;
        }
        const now = new Date();
        if (!reportCustomDate.value) {
          reportCustomDate.value = formatDateInput(now);
        }
      }

      function initAdminReportDate() {
        if (!adminReportDate) {
          return;
        }
        const now = new Date();
        if (!adminReportDate.value) {
          adminReportDate.value = formatDateInput(now);
        }
      }

      function initAdminReportMonth() {
        if (!adminReportMonth) {
          return;
        }
        const now = new Date();
        const monthValue = `${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, '0')}`;
        if (!adminReportMonth.value) {
          adminReportMonth.value = monthValue;
        }
      }

      function initSalesReport() {
        if (!salesStartDate || !salesEndDate) {
          return;
        }
        const now = new Date();
        const startMonth = new Date(now.getFullYear(), now.getMonth(), 1);
        if (!salesStartDate.value) {
          salesStartDate.value = formatDateInput(startMonth);
        }
        if (!salesEndDate.value) {
          salesEndDate.value = formatDateInput(now);
        }
        updateSalesReport();
      }

      function updateWalletBalance() {
        if (!accountState) {
          setSensitiveValue(walletBalance, 'R$ 0,00');
          setSensitiveValue(adminBalanceValue, 'R$ 0,00');
          if (walletBalanceInline) {
            setSensitiveValue(walletBalanceInline, 'R$ 0,00');
          }
          if (financeBalance) {
            setSensitiveValue(financeBalance, 'R$ 0,00');
          }
          if (financeAvailableBalance) {
            setSensitiveValue(financeAvailableBalance, 'R$ 0,00');
          }
          if (vipBonusValue) {
            setSensitiveValue(vipBonusValue, 'R$ 0,00');
          }
          if (adminBonusValue) {
            setSensitiveValue(adminBonusValue, 'R$ 0,00');
          }
          if (adminRollingValue) {
            setSensitiveValue(adminRollingValue, 'R$ 0,00');
          }
          return;
        }

        setSensitiveValue(walletBalance, formatCurrency(accountState.balance || 0));
        setSensitiveValue(adminBalanceValue, formatCurrency(accountState.balance || 0));
        if (walletBalanceInline) {
          setSensitiveValue(walletBalanceInline, formatCurrency(accountState.balance || 0));
        }
        if (financeBalance) {
          setSensitiveValue(financeBalance, formatCurrency(accountState.balance || 0));
        }
        if (financeAvailableBalance) {
          setSensitiveValue(financeAvailableBalance, formatCurrency(getAvailableBalance()));
        }
        if (vipBonusValue) {
          setSensitiveValue(vipBonusValue, formatCurrency(accountState.bonusBalance || 0));
        }
        if (adminBonusValue) {
          setSensitiveValue(adminBonusValue, formatCurrency(accountState.bonusBalance || 0));
        }
        if (adminRollingValue) {
          const rollingTotal = accountState.manualRollingSales ? Number(accountState.manualRollingSales.total || 0) : 0;
          setSensitiveValue(adminRollingValue, formatCurrency(rollingTotal));
        }
      }

      function showToast({ title, message, type = 'info' }) {
        if (!toastContainer) {
          return;
        }
        const toast = document.createElement('div');
        toast.className = `toast toast-${type}`;
        const safeMessage = applyPrivacyText(message);
        toast.innerHTML = `
          <div class="toast-title">${title}</div>
          <div class="toast-message">${safeMessage}</div>
        `;
        toastContainer.appendChild(toast);
        setTimeout(() => {
          toast.classList.add('toast-exit');
        }, 3600);
        setTimeout(() => {
          toast.remove();
        }, 4000);
      }

      function isTypingInForm() {
        const tag = document.activeElement?.tagName;
        return tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT';
      }

      function launchConfetti() {
        const confetti = document.createElement('div');
        confetti.className = 'confetti';
        const colors = ['#38bdf8', '#34d399', '#f59e0b', '#a855f7', '#f472b6'];
        const pieces = 28;
        for (let i = 0; i < pieces; i += 1) {
          const piece = document.createElement('span');
          piece.className = 'confetti-piece';
          piece.style.left = `${Math.random() * 100}%`;
          piece.style.background = colors[Math.floor(Math.random() * colors.length)];
          piece.style.animationDelay = `${Math.random() * 0.4}s`;
          piece.style.transform = `rotate(${Math.random() * 360}deg)`;
          confetti.appendChild(piece);
        }
        document.body.appendChild(confetti);
        document.body.classList.add('celebrate');
        setTimeout(() => {
          confetti.remove();
          document.body.classList.remove('celebrate');
        }, 1800);
      }

      function notifyNewTask(total) {
        showToast({
          title: 'Nova avaliação disponível',
          message: `Você tem ${total} avaliações para revisar agora.`,
          type: 'info'
        });
      }

      function notifyApproval(kind, value) {
        showToast({
          title: 'Aprovação confirmada',
          message: `${kind} aprovado: ${formatCurrency(value)} liberado.`,
          type: 'success'
        });
        launchConfetti();
      }

      function approveAllPending() {
        if (!accountState) {
          return;
        }
        let approvedBalanceCount = 0;
        let approvedBalanceValue = 0;
        let approvedWithdrawals = 0;
        let rejectedWithdrawals = 0;
        let approvedReviewCount = 0;

        accountState.balanceRequests = (accountState.balanceRequests || []).map((request) => {
          if (request.status !== 'pendente') {
            return request;
          }
          approvedBalanceCount += 1;
          const amount = Number(request.amount || 0);
          if (!Number.isNaN(amount)) {
            accountState.balance = roundCurrency((accountState.balance || 0) + amount);
            approvedBalanceValue += amount;
          }
          if (request.source === 'review' && request.reviewId) {
            accountState.reviews = accountState.reviews.map((review) => {
              if (review.id !== request.reviewId) {
                return review;
              }
              approvedReviewCount += 1;
              return {
                ...review,
                status: 'approved',
                approvedAt: Date.now()
              };
            });
          }
          return {
            ...request,
            status: 'aprovado',
            approvedAt: Date.now()
          };
        });

        accountState.withdrawalRequests = (accountState.withdrawalRequests || []).map((request) => {
          if (request.status !== 'pendente') {
            return request;
          }
          const amount = Number(request.amount || 0);
          if (!Number.isNaN(amount) && (accountState.balance || 0) >= amount) {
            accountState.balance = roundCurrency((accountState.balance || 0) - amount);
            approvedWithdrawals += 1;
            return {
              ...request,
              status: 'aprovado',
              approvedAt: Date.now()
            };
          }
          rejectedWithdrawals += 1;
          return {
            ...request,
            status: 'rejeitado',
            rejectedAt: Date.now()
          };
        });

        saveAccountState();
        updateAdminBalance();
        renderRequestList(accountState.balanceRequests || [], balanceRequestList, 'Sem solicitações de saldo.');
        renderRequestList(accountState.withdrawalRequests || [], withdrawalRequestList, 'Sem solicitações de saque.');
        renderFinanceLists();
        renderReviewList();
        renderAdminReviews();
        updateDashboardStats();

        if (approvedBalanceCount === 0 && approvedWithdrawals === 0 && rejectedWithdrawals === 0) {
          showToast({
            title: 'Aprovação em lote',
            message: 'Nenhuma pendência encontrada.',
            type: 'warning'
          });
          return;
        }

        const summaryParts = [];
        if (approvedBalanceCount > 0) {
          summaryParts.push(`${approvedBalanceCount} pagamento(s) aprovados (${formatCurrency(approvedBalanceValue)})`);
        }
        if (approvedReviewCount > 0) {
          summaryParts.push(`${approvedReviewCount} avaliações aprovadas`);
        }
        if (approvedWithdrawals > 0) {
          summaryParts.push(`${approvedWithdrawals} saque(s) aprovados`);
        }
        if (rejectedWithdrawals > 0) {
          summaryParts.push(`${rejectedWithdrawals} saque(s) rejeitados`);
        }
        showToast({
          title: 'Aprovação em lote concluída',
          message: summaryParts.join(' · '),
          type: 'success'
        });
        launchConfetti();
      }

      function updateAdminBalance() {
        updateWalletBalance();
      }

      function addActivity(text) {
        if (!accountState) {
          return;
        }
        const entry = {
          id: `activity-${Date.now()}`,
          text,
          createdAt: Date.now()
        };
        accountState.activities.unshift(entry);
        accountState.activities = accountState.activities.slice(0, 6);
        saveAccountState();
        renderActivities();
      }

      function renderActivities() {
        if (!accountState) {
          return;
        }
        if (!activityList) {
          return;
        }
        if (accountState.activities.length === 0) {
          activityList.innerHTML = '<li class="rounded-2xl border border-white/10 bg-ink-700/60 p-4 text-white/50">Nenhuma atividade recente.</li>';
          return;
        }
        activityList.innerHTML = accountState.activities
          .map((activity) => `<li class="rounded-2xl border border-white/10 bg-ink-700/60 p-4">${applyPrivacyText(activity.text)}</li>`)
          .join('');
      }

      function renderAlerts() {
        if (!accountState || !alertList) {
          return;
        }
        const now = Date.now();
        const pendingReviews = accountState.reviews.filter((review) => review.status === 'pending');
        const expiringSoon = pendingReviews.filter((review) => review.expiresAt && review.expiresAt - now <= 5 * 60 * 1000);
        const pendingBalances = (accountState.balanceRequests || []).filter((request) => request.status === 'pendente').length;
        const pendingWithdrawals = (accountState.withdrawalRequests || []).filter((request) => request.status === 'pendente').length;
        const alerts = [];

        if (pendingReviews.length > 0) {
          alerts.push(`Você tem ${pendingReviews.length} avaliações pendentes.`);
        }
        if (expiringSoon.length > 0) {
          alerts.push(`${expiringSoon.length} avaliações expiram em até 5 minutos.`);
        }
        if (pendingBalances > 0) {
          alerts.push(`${pendingBalances} pagamento(s) aguardando aprovação.`);
        }
        if (pendingWithdrawals > 0) {
          alerts.push(`${pendingWithdrawals} saque(s) aguardando aprovação.`);
        }
        if (getAvailableBalance() <= 5) {
          alerts.push('Saldo disponível baixo para novos saques.');
        }

        if (alerts.length === 0) {
          alertList.innerHTML = '<li class="rounded-2xl border border-white/10 bg-ink-700/60 p-4 text-white/50">Nenhum alerta crítico no momento.</li>';
          return;
        }

        alertList.innerHTML = alerts
          .map((alert) => `<li class="rounded-2xl border border-white/10 bg-ink-700/60 p-3">${applyPrivacyText(alert)}</li>`)
          .join('');
      }

      function renderTeamMembers() {
        if (!accountState || !teamMemberList) {
          return;
        }
        if (!accountState.teamMembers || accountState.teamMembers.length === 0) {
          teamMemberList.innerHTML = '<li class="text-white/50">Nenhum membro cadastrado.</li>';
          return;
        }
        teamMemberList.innerHTML = accountState.teamMembers
          .map((member) => {
            const statusClass = member.status === 'ativo' ? 'text-emerald-300' : 'text-white/50';
            return `
              <li class="rounded-xl border border-white/10 bg-ink-800/70 p-3">
                <div class="flex items-center justify-between gap-3">
                  <p class="text-sm font-semibold">${member.name}</p>
                  <span class="text-xs ${statusClass}">${member.status}</span>
                </div>
                <p class="mt-1 text-xs text-white/50">${member.role}</p>
              </li>
            `;
          })
          .join('');
      }

      function pruneExpiredReviews() {
        if (!accountState) {
          return;
        }
        const now = Date.now();
        accountState.reviews = accountState.reviews
          .map((review) => {
            if (!review.expiresAt) {
              const createdAt = review.createdAt || now;
              return {
                ...review,
                expiresAt: createdAt + reviewTTL,
                status: review.status || 'pending'
              };
            }
            return review;
          })
          .filter((review) => review.status !== 'pending' || review.expiresAt > now);
        saveAccountState();
      }

      function formatTimeLeft(expiresAt) {
        const diff = Math.max(0, expiresAt - Date.now());
        const minutes = Math.floor(diff / 60000);
        const seconds = Math.floor((diff % 60000) / 1000);
        return `${minutes}m ${seconds.toString().padStart(2, '0')}s`;
      }

      function updateNextReviewInfo() {
        if (!accountState || !accountState.nextReviewAt) {
          nextReviewInfo.textContent = 'Próxima em --';
          return;
        }
        const diff = Math.max(0, accountState.nextReviewAt - Date.now());
        const minutes = Math.floor(diff / 60000);
        const seconds = Math.floor((diff % 60000) / 1000);
        nextReviewInfo.textContent = `Próxima em ${minutes}m ${seconds.toString().padStart(2, '0')}s`;
      }

      function randomReward() {
        return Number((Math.random() * 12 + 5).toFixed(2));
      }

      function randomRange(min, max) {
        return min + Math.random() * (max - min);
      }

      function randomWeightedRange(min, max, weight) {
        return min + (max - min) * Math.pow(Math.random(), weight);
      }

      function calculateBonusByQuality(quality) {
        switch (quality) {
          case 'excelente':
            return roundCurrency(randomWeightedRange(80, 120, 0.35));
          case 'boa':
            return roundCurrency(randomWeightedRange(50, 85, 0.7));
          case 'regular':
            return roundCurrency(randomWeightedRange(25, 65, 1.1));
          case 'ruim':
            return roundCurrency(randomWeightedRange(10, 56, 1.4));
          default:
            return roundCurrency(randomRange(20, 60));
        }
      }

      function pickMarketplaceForReview() {
        if (!accountState || !Array.isArray(accountState.marketplaces)) {
          return marketplaceCatalog[Math.floor(Math.random() * marketplaceCatalog.length)];
        }
        const connected = accountState.marketplaces.filter((marketplace) => marketplace.connected);
        if (connected.length === 0) {
          return null;
        }
        return connected[Math.floor(Math.random() * connected.length)];
      }

      function getRandomReviewTemplate() {
        const marketplace = pickMarketplaceForReview();
        if (!marketplace) {
          return null;
        }
        const products = productCatalog[marketplace.id] || ['Produto destaque'];
        const productName = products[Math.floor(Math.random() * products.length)];
        return {
          marketplaceId: marketplace.id,
          marketplaceName: marketplace.name,
          productName,
          reward: randomReward()
        };
      }

      function slugify(value) {
        return String(value)
          .toLowerCase()
          .normalize('NFD')
          .replace(/[\u0300-\u036f]/g, '')
          .replace(/[^a-z0-9]+/g, '-')
          .replace(/(^-|-$)+/g, '');
      }

      function getProductLink(review) {
        const query = encodeURIComponent(review.productName);
        switch (review.marketplaceId) {
          case 'mercado_livre':
            return `https://lista.mercadolivre.com.br/${slugify(review.productName)}`;
          case 'shopee':
            return `https://shopee.com.br/search?keyword=${query}`;
          case 'amazon':
            return `https://www.amazon.com.br/s?k=${query}`;
          case 'magalu':
            return `https://www.magazineluiza.com.br/busca/${slugify(review.productName)}`;
          case 'shein':
            return `https://br.shein.com/search?q=${query}`;
          case 'aliexpress':
            return `https://pt.aliexpress.com/wholesale?SearchText=${query}`;
          default:
            return `https://www.google.com/search?q=${query}`;
        }
      }

      function hashString(value) {
        let hash = 0;
        for (let i = 0; i < value.length; i += 1) {
          hash = (hash << 5) - hash + value.charCodeAt(i);
          hash |= 0;
        }
        return Math.abs(hash);
      }

      function getProductMeta(productName, marketplaceName) {
        const hash = hashString(`${productName}-${marketplaceName}`);
        const price = (hash % 850) + 49.9;
        const categories = ['Eletronicos', 'Casa & Cozinha', 'Moda', 'Acessorios', 'Gadgets', 'Fitness'];
        const category = categories[hash % categories.length];
        const sku = `RP-${hash.toString().slice(0, 6).padStart(6, '0')}`;
        const warrantyMonths = (hash % 18) + 6;
        const delivery = hash % 2 === 0 ? 'Entrega: 24-48h' : 'Entrega: 3-7 dias';
        const condition = 'Condição: Novo lacrado';
        const description = `Anuncio verificado para ${productName}. Oferta exclusiva do marketplace ${marketplaceName} com garantia e suporte VIP. Confira as especificações completas abaixo.`;
        const specs = [
          `Garantia: ${warrantyMonths} meses`,
          delivery,
          condition,
          `Origem: ${marketplaceName}`,
          `SKU: ${sku}`
        ];
        return {
          price,
          category,
          sku,
          description,
          specs
        };
      }

      function openProductOverlay(review) {
        if (!productOverlay) {
          return;
        }
        const meta = review.productMeta || getProductMeta(review.productName, review.marketplaceName);
        productAdTitle.textContent = review.productName;
        productAdMarketplace.textContent = `${review.marketplaceName} · Anuncio oficial`;
        productAdCategory.textContent = meta.category;
        productAdSku.textContent = meta.sku;
        productAdDescription.textContent = meta.description;
        if (productAdSpecs) {
          const specs = Array.isArray(meta.specs) ? meta.specs : [];
          if (specs.length === 0) {
            productAdSpecs.innerHTML = '<li>Especificações indisponíveis no momento.</li>';
          } else {
            productAdSpecs.innerHTML = specs.map((spec) => `<li>${applyPrivacyText(spec)}</li>`).join('');
          }
        }
        setSensitiveValue(productAdPrice, formatCurrency(meta.price));
        productOverlay.classList.remove('hidden');
        productOverlay.classList.add('flex');
      }

      function closeProductOverlay() {
        if (!productOverlay) {
          return;
        }
        productOverlay.classList.add('hidden');
        productOverlay.classList.remove('flex');
      }

      function createReviewItem(template, source) {
        const now = Date.now();
        const productMeta = getProductMeta(template.productName, template.marketplaceName);
        return {
          id: `review-${now}-${Math.random().toString(16).slice(2, 6)}`,
          marketplaceId: template.marketplaceId,
          marketplaceName: template.marketplaceName,
          productName: template.productName,
          productMeta,
          reward: Number(template.reward || 0),
          source,
          status: 'pending',
          createdAt: now,
          expiresAt: now + reviewTTL
        };
      }

      function scheduleNextReview() {
        if (!accountState) {
          return;
        }

        const now = Date.now();
        if (!accountState.nextReviewAt || now >= accountState.nextReviewAt) {
          const interval = reviewIntervals[accountState.reviewIntervalIndex % reviewIntervals.length];
          const activeCount = accountState.reviews.filter((review) => review.status === 'pending').length;
          let createdCount = 0;
          if (activeCount < 8) {
            const template = getRandomReviewTemplate();
            if (template) {
              accountState.reviews.unshift(createReviewItem(template, 'auto'));
              createdCount = 1;
              const nextCount = activeCount + 1;
              if (nextCount > lastPendingReviewCount) {
                notifyNewTask(nextCount);
                lastPendingReviewCount = nextCount;
              }
            }
          }
          accountState.reviewIntervalIndex = (accountState.reviewIntervalIndex + 1) % reviewIntervals.length;
          accountState.nextReviewAt = now + interval * 60 * 1000;
          lastPendingReviewCount = activeCount + createdCount;
          saveAccountState();
          renderReviewList();
        }

        updateNextReviewInfo();
        clearTimeout(taskTimer);
        const delay = Math.max(1000, accountState.nextReviewAt - Date.now());
        taskTimer = setTimeout(scheduleNextReview, delay);
      }

      function renderReviewList(suppressNotify = false) {
        if (!accountState) {
          return;
        }
        pruneExpiredReviews();
        updateNextReviewInfo();

        const activeReviews = accountState.reviews.filter((review) => review.status === 'pending');
        if (!suppressNotify && activeReviews.length !== lastPendingReviewCount && activeReviews.length > lastPendingReviewCount) {
          notifyNewTask(activeReviews.length);
        }
        lastPendingReviewCount = activeReviews.length;
        if (activeReviews.length === 0) {
          reviewList.innerHTML = '<li class="text-white/50">Sem avaliações no momento. Aguarde novas recomendações.</li>';
          if (reviewListSecondary) {
            reviewListSecondary.innerHTML = '<li class="text-white/50">Sem avaliações no momento. Aguarde novas recomendações.</li>';
          }
          updateDashboardStats();
          renderProductHighlights();
          return;
        }

        const html = activeReviews
          .map(
            (review) => `
            <li class="rounded-2xl border border-white/10 bg-ink-700/60 p-4">
              <div class="flex flex-wrap items-center justify-between gap-3">
                <div>
                  <p class="text-sm font-semibold">${review.marketplaceName} · ${review.productName}</p>
                  <p class="text-xs text-white/60">Recompensa: ${applyPrivacyText(formatCurrency(review.reward))}</p>
                </div>
                <button data-review-id="${review.id}" class="text-xs text-emerald-200 hover:text-emerald-100">Avaliar</button>
              </div>
              <div class="mt-2 flex flex-wrap items-center justify-between gap-2 text-xs text-white/50">
                <span>${review.source === 'admin' ? 'Manual' : 'Automática'}</span>
                <span>Expira em ${formatTimeLeft(review.expiresAt)}</span>
              </div>
            </li>
          `
          )
          .join('');

        reviewList.innerHTML = html;
        if (reviewListSecondary) {
          reviewListSecondary.innerHTML = html;
        }
        updateDashboardStats();
        renderProductHighlights();
      }

      let activeReviewId = null;

      function openReviewOverlay(review) {
        activeReviewId = review.id;
        setSensitiveValue(
          reviewProductInfo,
          `${review.marketplaceName} · ${review.productName} · ${formatCurrency(review.reward)}`
        );
        resetReviewForm();
        reviewOverlay.classList.remove('hidden');
        reviewOverlay.classList.add('flex');
      }

      function closeReviewOverlay() {
        reviewOverlay.classList.add('hidden');
        reviewOverlay.classList.remove('flex');
        activeReviewId = null;
        if (reviewTutorialOverlay) {
          reviewTutorialOverlay.classList.add('hidden');
          reviewTutorialOverlay.classList.remove('flex');
        }
      }

      function resetReviewForm() {
        reviewMessage.textContent = '';
        reviewFeedback.value = '';
        reviewTitle.value = '';
        if (reviewSku) {
          reviewSku.value = '';
        }
        reviewRecommend.value = '';
        reviewQuality.value = '';
        reviewRatingInputs.forEach((input) => {
          input.checked = false;
        });
        if (reviewTutorialOverlay) {
          reviewTutorialOverlay.classList.add('hidden');
        }
      }

      function renderAdminReviews() {
        if (!accountState) {
          return;
        }
        const adminReviews = accountState.reviews.filter((review) => review.source === 'admin' && review.status === 'pending');
        if (adminReviews.length === 0) {
          adminReviewList.innerHTML = '<li class="text-white/50">Nenhuma avaliação manual cadastrada.</li>';
          return;
        }
        adminReviewList.innerHTML = adminReviews
          .map(
            (review) => `
            <li class="rounded-xl border border-white/10 bg-ink-800/70 p-3">
              <div class="flex items-center justify-between gap-3">
                <div>
                  <p class="text-sm font-semibold">${review.marketplaceName} · ${review.productName}</p>
                  <p class="text-xs text-white/60">${applyPrivacyText(formatCurrency(review.reward))} · Expira em ${formatTimeLeft(review.expiresAt)}</p>
                </div>
                <button data-admin-review-remove="${review.id}" class="text-xs text-rose-300 hover:text-rose-200">Remover</button>
              </div>
            </li>
          `
          )
          .join('');
      }

      function renderAdminReportList() {
        if (!adminReportList || !accountState) {
          return;
        }
        const manualSales = Array.isArray(accountState.manualSales) ? accountState.manualSales : [];
        if (manualSales.length === 0) {
          adminReportList.innerHTML = '<li class="text-white/50">Nenhum resultado manual cadastrado.</li>';
          return;
        }
        const sorted = [...manualSales].sort((a, b) => (a.date < b.date ? 1 : -1));
        adminReportList.innerHTML = sorted
          .map((entry) => {
            const date = parseDateKey(entry.date);
            const label = date ? date.toLocaleDateString('pt-BR') : entry.date;
            return `
              <li class="rounded-xl border border-white/10 bg-ink-800/70 p-3">
                <div class="flex items-center justify-between gap-3">
                  <div>
                    <p class="text-sm font-semibold">${label}</p>
                    <p class="text-xs text-white/60">${applyPrivacyText(formatCurrency(entry.value))}</p>
                  </div>
                  <button data-admin-report-remove="${entry.date}" class="text-xs text-rose-300 hover:text-rose-200">Remover</button>
                </div>
              </li>
            `;
          })
          .join('');
      }

      function formatMonthLabel(monthKey) {
        const parts = String(monthKey || '').split('-').map(Number);
        if (parts.length < 2 || !parts[0] || !parts[1]) {
          return monthKey;
        }
        const date = new Date(parts[0], parts[1] - 1, 1);
        return date.toLocaleDateString('pt-BR', { month: 'long', year: 'numeric' });
      }

      function renderAdminReportMonthList() {
        if (!adminReportMonthList || !accountState) {
          return;
        }
        const manualMonths = Array.isArray(accountState.manualSalesMonths) ? accountState.manualSalesMonths : [];
        if (manualMonths.length === 0) {
          adminReportMonthList.innerHTML = '<li class="text-white/50">Nenhum mes cadastrado.</li>';
          return;
        }
        const sorted = [...manualMonths].sort((a, b) => (a.month < b.month ? 1 : -1));
        adminReportMonthList.innerHTML = sorted
          .map((entry) => {
            const label = formatMonthLabel(entry.month);
            return `
              <li class="rounded-xl border border-white/10 bg-ink-800/70 p-3">
                <div class="flex items-center justify-between gap-3">
                  <div>
                    <p class="text-sm font-semibold">${label}</p>
                    <p class="text-xs text-white/60">${applyPrivacyText(formatCurrency(entry.value))}</p>
                  </div>
                  <button data-admin-report-month-remove="${entry.month}" class="text-xs text-rose-300 hover:text-rose-200">Remover</button>
                </div>
              </li>
            `;
          })
          .join('');
      }

      function renderRequestList(list, container, emptyText, showActions = true) {
        if (list.length === 0) {
          container.innerHTML = `<li class="text-white/50">${emptyText}</li>`;
          return;
        }

        container.innerHTML = list
          .map((request) => {
            const statusColor =
              request.status === 'aprovado' ? 'text-emerald-300' : request.status === 'rejeitado' ? 'text-rose-300' : 'text-white/60';
            const actions =
              showActions && request.status === 'pendente'
                ? `
                <div class="mt-2 flex gap-2">
                  <button data-action="aprovar" data-request-id="${request.id}" class="rounded-full border border-emerald-400/30 px-3 py-1 text-xs text-emerald-200">Aprovar</button>
                  <button data-action="rejeitar" data-request-id="${request.id}" class="rounded-full border border-rose-400/30 px-3 py-1 text-xs text-rose-200">Rejeitar</button>
                </div>`
                : '';

            const label = applyPrivacyText(request.label);
            const amount = applyPrivacyText(formatCurrency(request.amount));
            const originText = request.source === 'review' ? 'Origem: avaliação pendente' : '';
            return `
              <li class="rounded-xl border border-white/10 bg-ink-800/70 p-3">
                <div class="flex items-center justify-between gap-3">
                  <p class="text-sm font-semibold">${label}</p>
                  <span class="text-xs text-white/50">${amount}</span>
                </div>
                <p class="mt-1 text-xs ${statusColor}">Status: ${request.status}</p>
                ${originText ? `<p class="mt-1 text-xs text-white/40">${originText}</p>` : ''}
                ${actions}
              </li>
            `;
          })
          .join('');
      }

      function renderAllAdminLists() {
        renderAdminReviews();
        renderAdminReportList();
        renderAdminReportMonthList();
        renderRequestList(accountState?.balanceRequests || [], balanceRequestList, 'Sem solicitações de saldo.');
        renderRequestList(accountState?.withdrawalRequests || [], withdrawalRequestList, 'Sem solicitações de saque.');
        renderFinanceLists();
        renderTeamMembers();
        updateDashboardStats();
      }

      function renderFinanceLists() {
        if (!accountState) {
          return;
        }
        if (financeBalanceRequestList) {
          renderRequestList(accountState.balanceRequests || [], financeBalanceRequestList, 'Sem pagamentos pendentes.', false);
        }
        if (financeWithdrawalList) {
          renderRequestList(accountState.withdrawalRequests || [], financeWithdrawalList, 'Sem solicitações de saque.', false);
        }
      }

      function formatRelativeTime(value) {
        if (!value) {
          return 'Sem sync';
        }
        const diff = Date.now() - new Date(value).getTime();
        if (Number.isNaN(diff)) {
          return 'Sem sync';
        }
        const minutes = Math.floor(diff / 60000);
        if (minutes < 1) {
          return 'Agora';
        }
        if (minutes < 60) {
          return `${minutes} min atrás`;
        }
        const hours = Math.floor(minutes / 60);
        return `${hours}h atrás`;
      }

      function renderMarketplaces() {
        if (!accountState) {
          return;
        }
        if (!Array.isArray(accountState.marketplaces) || accountState.marketplaces.length === 0) {
          accountState.marketplaces = defaultMarketplaces();
          saveAccountState();
        }

        const html = accountState.marketplaces
          .map((marketplace) => {
            const badgeClass = marketplace.connected
              ? 'bg-emerald-500/20 text-emerald-200 border-emerald-500/30'
              : 'bg-white/5 text-white/60 border-white/10';
            const buttonLabel = marketplace.connected ? 'Desconectar' : 'Conectar';
            const syncText = marketplace.connected ? `Última sync: ${formatRelativeTime(marketplace.lastSync)}` : 'Sem sync';
            return `
              <li class="rounded-2xl border border-white/10 bg-ink-700/60 p-4">
                <div class="flex items-center justify-between gap-3">
                  <div>
                    <p class="text-sm font-semibold">${marketplace.name}</p>
                    <p class="text-xs text-white/50">${syncText}</p>
                  </div>
                  <div class="flex flex-col items-end gap-2">
                    <span class="rounded-full border px-3 py-1 text-xs ${badgeClass}">
                      ${marketplace.connected ? 'Conectado' : 'Desconectado'}
                    </span>
                    <button
                      data-marketplace-id="${marketplace.id}"
                      class="rounded-full border border-white/10 px-3 py-1 text-xs text-white/80 hover:bg-white/10"
                      type="button"
                    >
                      ${buttonLabel}
                    </button>
                  </div>
                </div>
              </li>
            `;
          })
          .join('');

        marketplaceList.innerHTML = html;
        if (marketplaceListSecondary) {
          marketplaceListSecondary.innerHTML = html;
        }
      }

      function renderProductHighlights() {
        if (!productHighlights) {
          return;
        }
        const allProducts = Object.values(productCatalog).flat();
        const counts = {};
        if (accountState) {
          accountState.reviews.forEach((review) => {
            if (!review.productName) {
              return;
            }
            counts[review.productName] = (counts[review.productName] || 0) + 1;
          });
        }
        const uniqueProducts = [...new Set(allProducts)];
        const sortedProducts = uniqueProducts.sort((a, b) => (counts[b] || 0) - (counts[a] || 0));
        const topProducts = sortedProducts.slice(0, 6);
        productHighlights.innerHTML = topProducts
          .map((name) => {
            const total = counts[name] || 0;
            return `
              <li class="rounded-2xl border border-white/10 bg-ink-700/60 p-4">
                <p class="text-sm font-semibold">${name}</p>
                <p class="text-xs text-white/50">${applyPrivacyText(`${total} avaliações registradas`)}</p>
              </li>
            `;
          })
          .join('');
      }

      const memberPulseNames = [
        'Ana',
        'Bruno',
        'Camila',
        'Diego',
        'Fernanda',
        'Gustavo',
        'Helena',
        'Igor',
        'Juliana',
        'Lucas',
        'Mariana',
        'Rafael'
      ];
      function getMemberMarketplaceOptions() {
        if (accountState && Array.isArray(accountState.marketplaces) && accountState.marketplaces.length > 0) {
          return accountState.marketplaces.map((item) => item.name);
        }
        return marketplaceCatalog.map((item) => item.name);
      }
      const memberPulseCities = [
        'São Paulo, SP',
        'Rio de Janeiro, RJ',
        'Belo Horizonte, MG',
        'Curitiba, PR',
        'Recife, PE',
        'Fortaleza, CE',
        'Salvador, BA',
        'Brasília, DF',
        'Goiânia, GO',
        'Porto Alegre, RS'
      ];
      const memberPulseFeedbacks = [
        'Achei a navegação bem tranquila, dá pra resolver tudo rápido.',
        'O painel fica limpo mesmo com bastante tarefa.',
        'As aprovações agora fazem sentido, ficou mais organizado.',
        'Gostei do resumo no fim do dia, ajuda a ter visão geral.',
        'O fluxo de avaliação está mais estável e sem travar.',
        'A parte financeira ficou clara, sem confusão.',
        'Consigo acompanhar as tarefas sem perder tempo.',
        'Visual bonito e direto, sem excesso de informação.'
      ];
      const memberPulseTags = ['Fluxo rápido', 'Operação estável', 'Painel claro', 'ROI em alta', 'Equipe focada'];
      let memberPulseData = [];
      let memberPulseUpdatedAt = null;

      function buildMemberPulseData(count = 6) {
        const data = [];
        for (let i = 0; i < count; i += 1) {
          const reviews = Math.max(4, Math.round(randomRange(6, 45)));
          const approvals = Math.min(reviews, Math.max(1, Math.round(randomRange(3, reviews))));
          const rating = (Math.round(randomRange(43, 50)) / 10).toFixed(1);
          const avgTime = Math.round(randomRange(4, 18));
          const earnings = roundCurrency(randomRange(120, 980));
          data.push({
            name: memberPulseNames[Math.floor(Math.random() * memberPulseNames.length)],
            marketplace: getMemberMarketplaceOptions()[
              Math.floor(Math.random() * getMemberMarketplaceOptions().length)
            ],
            city: memberPulseCities[Math.floor(Math.random() * memberPulseCities.length)],
            tag: memberPulseTags[Math.floor(Math.random() * memberPulseTags.length)],
            comment: memberPulseFeedbacks[Math.floor(Math.random() * memberPulseFeedbacks.length)],
            rating,
            reviews,
            approvals,
            avgTime,
            earnings
          });
        }
        return data;
      }

      function renderMemberPulse() {
        if (!memberPulseList || !memberPulseSummary) {
          return;
        }
        if (memberPulseData.length === 0) {
          memberPulseSummary.innerHTML = '';
          memberPulseList.innerHTML = '<li class="text-white/50">Sem atualizações no momento.</li>';
          return;
        }

        const totalReviews = memberPulseData.reduce((sum, item) => sum + item.reviews, 0);
        const avgRating =
          memberPulseData.reduce((sum, item) => sum + Number(item.rating || 0), 0) / Math.max(1, memberPulseData.length);
        const avgTime = memberPulseData.reduce((sum, item) => sum + item.avgTime, 0) / Math.max(1, memberPulseData.length);
        const totalEarnings = memberPulseData.reduce((sum, item) => sum + item.earnings, 0);

        memberPulseSummary.innerHTML = `
          <div class="rounded-2xl border border-white/10 bg-ink-700/60 p-3">
            <p class="text-xs text-white/50">Membros ativos</p>
            <p class="text-lg font-semibold">${applyPrivacyText(memberPulseData.length)}</p>
          </div>
          <div class="rounded-2xl border border-white/10 bg-ink-700/60 p-3">
            <p class="text-xs text-white/50">Avaliações feitas</p>
            <p class="text-lg font-semibold">${applyPrivacyText(totalReviews)}</p>
          </div>
          <div class="rounded-2xl border border-white/10 bg-ink-700/60 p-3">
            <p class="text-xs text-white/50">Satisfação média</p>
            <p class="text-lg font-semibold">${applyPrivacyText(avgRating.toFixed(1))}★</p>
          </div>
          <div class="rounded-2xl border border-white/10 bg-ink-700/60 p-3">
            <p class="text-xs text-white/50">Ganhos estimados</p>
            <p class="text-lg font-semibold">${applyPrivacyText(formatCurrency(totalEarnings))}</p>
          </div>
        `;

        memberPulseList.innerHTML = memberPulseData
          .map((member) => {
            const ratingText = applyPrivacyText(`${member.rating}★`);
            const reviewsText = applyPrivacyText(`${member.reviews}`);
            const approvalsText = applyPrivacyText(`${member.approvals}`);
            const timeText = applyPrivacyText(`${member.avgTime} min`);
            const earningsText = applyPrivacyText(formatCurrency(member.earnings));
            return `
              <li class="rounded-2xl border border-white/10 bg-ink-700/60 p-3 transition hover:bg-white/5">
                <div class="flex items-start justify-between gap-3">
                  <div>
                    <p class="text-sm font-semibold">${member.name}</p>
                    <p class="text-xs text-white/60">${member.marketplace} · ${member.city}</p>
                  </div>
                  <span class="rounded-full border border-emerald-400/30 bg-emerald-400/10 px-2 py-1 text-[10px] text-emerald-200">${ratingText}</span>
                </div>
                <p class="mt-2 text-xs text-white/70">${applyPrivacyText(member.comment)}</p>
                <div class="mt-3 grid gap-2 text-[11px] text-white/60 md:grid-cols-2">
                  <div class="rounded-xl border border-white/10 px-2 py-1">Avaliações: <span class="text-white">${reviewsText}</span></div>
                  <div class="rounded-xl border border-white/10 px-2 py-1">Aprovadas: <span class="text-white">${approvalsText}</span></div>
                  <div class="rounded-xl border border-white/10 px-2 py-1">Tempo médio: <span class="text-white">${timeText}</span></div>
                  <div class="rounded-xl border border-white/10 px-2 py-1">Ganhos: <span class="text-white">${earningsText}</span></div>
                </div>
                <div class="mt-2 flex flex-wrap gap-2 text-[10px] text-white/60">
                  <span class="rounded-full border border-white/10 px-2 py-1">${member.tag}</span>
                  <span class="rounded-full border border-white/10 px-2 py-1">Atualizado recentemente</span>
                </div>
              </li>
            `;
          })
          .join('');

        if (memberPulseUpdated) {
          const label = memberPulseUpdatedAt ? `Atualizado ${formatRelativeTime(memberPulseUpdatedAt)}` : 'Atualizado agora';
          memberPulseUpdated.textContent = label;
        }
      }

      function refreshMemberPulse() {
        memberPulseData = buildMemberPulseData(3);
        memberPulseUpdatedAt = Date.now();
        renderMemberPulse();
      }

      function updateDashboardStats() {
        if (!accountState) {
          return;
        }
        const now = Date.now();
        const pendingReviews = accountState.reviews.filter((review) => review.status === 'pending');
        const completedReviews = accountState.reviews.filter((review) => review.status !== 'pending');
        const expiringSoon = pendingReviews.filter((review) => review.expiresAt && review.expiresAt - now <= 5 * 60 * 1000);
        const pendingBalances = (accountState.balanceRequests || []).filter((request) => request.status === 'pendente').length;
        const withdrawalRequests = accountState.withdrawalRequests || [];
        const pendingWithdrawals = withdrawalRequests.filter((request) => request.status === 'pendente').length;
        const approvedWithdrawals = withdrawalRequests.filter((request) => request.status === 'aprovado').length;
        const rejectedWithdrawals = withdrawalRequests.filter((request) => request.status === 'rejeitado').length;
        const approvedReviews = accountState.reviews.filter((review) => review.status === 'approved').length;
        const ratingReviews = accountState.reviews.filter((review) => review.details && Number(review.details.rating));
        const ratingTotal = ratingReviews.reduce((total, review) => total + Number(review.details.rating || 0), 0);
        const averageRating = ratingReviews.length > 0 ? ratingTotal / ratingReviews.length : 0;
        const reviewRequests = (accountState.balanceRequests || []).filter((request) => request.source === 'review');
        const walletCreditsTotal = (accountState.walletCredits || []).reduce((total, entry) => {
          const value = Number(entry.amount || 0);
          return Number.isNaN(value) ? total : total + value;
        }, 0);

        const approvedValue =
          reviewRequests
            .filter((request) => request.status === 'aprovado')
            .reduce((total, request) => total + Number(request.amount || 0), 0) +
          walletCreditsTotal;
        const pendingValue = reviewRequests
          .filter((request) => request.status === 'pendente')
          .reduce((total, request) => total + Number(request.amount || 0), 0);
        const decidedReviews = accountState.reviews.filter((review) => review.status === 'approved' || review.status === 'rejected');
        const approvalRate = decidedReviews.length > 0 ? (approvedReviews / decidedReviews.length) * 100 : 0;
        const approvalTimes = accountState.reviews
          .filter((review) => review.approvedAt && review.completedAt)
          .map((review) => (review.approvedAt - review.completedAt) / 60000)
          .filter((value) => value >= 0);
        const avgApprovalTime =
          approvalTimes.length > 0 ? approvalTimes.reduce((total, value) => total + value, 0) / approvalTimes.length : null;

        setSensitiveValue(statActiveReviews, pendingReviews.length);
        if (statActiveReviewsMirror) {
          setSensitiveValue(statActiveReviewsMirror, pendingReviews.length);
        }
        setSensitiveValue(statExpiringReviews, expiringSoon.length);
        setSensitiveValue(statPendingBalances, pendingBalances);
        setSensitiveValue(statPendingWithdrawals, pendingWithdrawals);
        if (statCompletedReviews) {
          setSensitiveValue(statCompletedReviews, completedReviews.length);
        }
        if (vipBonusValue) {
          setSensitiveValue(vipBonusValue, formatCurrency(accountState.bonusBalance || 0));
        }
        if (financePendingBalance) {
          setSensitiveValue(financePendingBalance, pendingBalances);
        }
        if (financePendingWithdrawals) {
          setSensitiveValue(financePendingWithdrawals, pendingWithdrawals);
        }
        if (financeApprovedWithdrawals) {
          setSensitiveValue(financeApprovedWithdrawals, approvedWithdrawals);
        }
        if (financeRejectedWithdrawals) {
          setSensitiveValue(financeRejectedWithdrawals, rejectedWithdrawals);
        }
        if (reportAverageRating) {
          setSensitiveValue(reportAverageRating, averageRating ? averageRating.toFixed(1) : '0.0');
        }
        if (reportApprovalRate) {
          setSensitiveValue(reportApprovalRate, `${approvalRate.toFixed(0)}%`);
        }
        if (reportApprovalTime) {
          setSensitiveValue(reportApprovalTime, avgApprovalTime ? `${Math.round(avgApprovalTime)} min` : '--');
        }
        if (reportApprovedValue) {
          setSensitiveValue(reportApprovedValue, formatCurrency(approvedValue));
        }
        if (reportPendingValue) {
          setSensitiveValue(reportPendingValue, formatCurrency(pendingValue));
        }
        if (reportApprovedReviews) {
          setSensitiveValue(reportApprovedReviews, approvedReviews);
        }
        renderAlerts();
        updateSalesReport();
        updateReportSummary();
      }

      function startCountdownTimer() {
        clearInterval(countdownTimer);
        countdownTimer = setInterval(() => {
          if (!accountState) {
            return;
          }
          pruneExpiredReviews();
          renderReviewList();
          renderAdminReviews();
        }, 15000);
      }

      navItems.forEach((item) => {
        item.addEventListener('click', () => {
          setActiveSection(item.dataset.sectionTarget);
        });
      });

      document.getElementById('loginForm').addEventListener('submit', (event) => {
        event.preventDefault();
        const form = event.target;
        authMessage.textContent = '';

        if (isLocalPasswordValid(form.password.value)) {
          safeStorageSet(localAuthKey, 'true');
          try {
            setUserInfo({ id: 'local-user' });
          } catch (error) {
            console.error('Erro ao iniciar conta:', error);
          }
          setStatus('Conectado');
          showApp();
          return;
        }

        authMessage.textContent = 'Senha incorreta. Tente novamente.';
        setStatus('Desconectado');
      });

      logoutButton.addEventListener('click', () => {
        safeStorageRemove(localAuthKey);
        clearTimeout(taskTimer);
        clearInterval(countdownTimer);
        showAuth();
        authMessage.textContent = 'Logout realizado.';
      });

      adminClose.addEventListener('click', closeAdminOverlay);

      if (quickSync) {
        quickSync.addEventListener('click', () => {
          if (!accountState) {
            return;
          }
          accountState.marketplaces = (accountState.marketplaces || []).map((marketplace) => ({
            ...marketplace,
            connected: true,
            lastSync: new Date().toISOString()
          }));
          saveAccountState();
          renderMarketplaces();
          addActivity('Marketplaces sincronizados com sucesso.');
        });
      }

      if (quickGenerate) {
        quickGenerate.addEventListener('click', () => {
          if (!accountState) {
            return;
          }
          const activeCount = accountState.reviews.filter((review) => review.status === 'pending').length;
          const maxPending = 12;
          const desiredNew = 3;
          const createCount = Math.min(desiredNew, Math.max(0, maxPending - activeCount));
          if (createCount === 0) {
            showToast({
              title: 'Fila cheia',
              message: 'Você já tem avaliações suficientes no momento.',
              type: 'warning'
            });
            return;
          }
          let createdCount = 0;
          for (let i = 0; i < createCount; i += 1) {
            const template = getRandomReviewTemplate();
            if (!template) {
              break;
            }
            accountState.reviews.unshift(createReviewItem(template, 'auto'));
            createdCount += 1;
          }
          if (createdCount === 0) {
            showToast({
              title: 'Marketplace desconectado',
              message: 'Conecte ao menos um marketplace para gerar novas avaliações.',
              type: 'warning'
            });
            return;
          }
          saveAccountState();
          renderReviewList();
          updateDashboardStats();
          addActivity(`Geradas ${createdCount} novas avaliações recomendadas.`);
          showToast({
            title: 'Novas avaliações',
            message: `${createdCount} novas avaliações adicionadas.`,
            type: 'info'
          });
        });
      }

      if (quickSummary) {
        quickSummary.addEventListener('click', () => {
          if (!accountState) {
            return;
          }
          const now = new Date();
          const startToday = new Date(now.getFullYear(), now.getMonth(), now.getDate(), 0, 0, 0, 0);
          const endToday = new Date(now.getFullYear(), now.getMonth(), now.getDate(), 23, 59, 59, 999);
          const bonusToday = sumBonusEarnedBetween(startToday, endToday);
          showToast({
            title: 'Resumo VIP do dia',
            message: `Bônus de hoje: ${formatCurrency(bonusToday)}.`,
            type: 'info'
          });
          addActivity(`Resumo VIP do dia: bônus hoje ${formatCurrency(bonusToday)}.`);
        });
      }

      if (memberPulseRefresh) {
        memberPulseRefresh.addEventListener('click', () => {
          refreshMemberPulse();
        });
      }
      refreshMemberPulse();
      setInterval(() => {
        refreshMemberPulse();
      }, 5 * 60 * 1000);

      if (salesApply) {
        salesApply.addEventListener('click', () => {
          updateSalesReport();
        });
      }

      if (reportRangeSelect) {
        reportRangeSelect.addEventListener('change', () => {
          updateReportSummary();
        });
      }

      window.addEventListener('resize', () => {
        updateReportSummary();
      });

      adminBalanceForm.addEventListener('submit', async (event) => {
        event.preventDefault();
        adminBalanceMessage.textContent = '';
        adminBalanceMessage.className = 'mt-3 text-xs text-white/60';

        const amount = parseAmount(adminBalanceAmount.value);
        if (amount === null) {
          adminBalanceMessage.textContent = 'Informe um valor válido.';
          adminBalanceMessage.classList.add('text-rose-300');
          return;
        }

        if (!accountState) {
          adminBalanceMessage.textContent = 'Conta indisponível.';
          adminBalanceMessage.classList.add('text-rose-300');
          return;
        }

        accountState.balance = roundCurrency((accountState.balance || 0) + amount);
        recordWalletCredit(amount, 'admin', 'Saldo admin');
        saveAccountState();
        updateAdminBalance();
        renderFinanceLists();
        updateDashboardStats();
        adminBalanceMessage.textContent = applyPrivacyText(
          `Saldo atualizado. Novo saldo: ${formatCurrency(accountState.balance)}`
        );
        adminBalanceMessage.classList.add('text-emerald-300');
      });

      if (adminBonusForm) {
        adminBonusForm.addEventListener('submit', (event) => {
          event.preventDefault();
          adminBonusMessage.textContent = '';
          adminBonusMessage.className = 'mt-3 text-xs text-white/60';
          if (!accountState) {
            adminBonusMessage.textContent = 'Conta indisponível.';
            adminBonusMessage.classList.add('text-rose-300');
            return;
          }
          const amount = parseAmount(adminBonusAmount.value);
          if (amount === null) {
            adminBonusMessage.textContent = 'Informe um valor válido.';
            adminBonusMessage.classList.add('text-rose-300');
            return;
          }
          recordBonusEarned(amount, 'admin', 'Bônus manual');
          accountState.bonusBalance = roundCurrency((accountState.bonusBalance || 0) + amount);
          saveAccountState();
          updateWalletBalance();
          updateDashboardStats();
          adminBonusMessage.textContent = applyPrivacyText(
            `Bônus atualizado. Novo bônus: ${formatCurrency(accountState.bonusBalance)}`
          );
          adminBonusMessage.classList.add('text-emerald-300');
          adminBonusForm.reset();
        });
      }

      if (adminRollingForm) {
        adminRollingForm.addEventListener('submit', (event) => {
          event.preventDefault();
          adminRollingMessage.textContent = '';
          adminRollingMessage.className = 'mt-3 text-xs text-white/60';

          if (!accountState) {
            adminRollingMessage.textContent = 'Conta indisponivel.';
            adminRollingMessage.classList.add('text-rose-300');
            return;
          }

          const amount = parseAmountAllowZero(adminRollingAmount?.value);
          if (amount === null) {
            adminRollingMessage.textContent = 'Informe um valor valido.';
            adminRollingMessage.classList.add('text-rose-300');
            return;
          }

          accountState.manualRollingSales = {
            total: roundCurrency(amount),
            updatedAt: new Date().toISOString()
          };
          accountState.manualSales = [];
          accountState.manualSalesMonths = [];
          accountState.lastManualSaleDate = null;

          saveAccountState();
          updateWalletBalance();
          updateSalesReport();
          if (reportRangeSelect) {
            reportRangeSelect.value = 'last30';
          }
          updateReportSummary();
          addActivity(`Total 30 dias ajustado para ${formatCurrency(amount)}.`);

          adminRollingMessage.textContent = 'Total 30 dias atualizado.';
          adminRollingMessage.classList.add('text-emerald-300');
          if (adminRollingAmount) {
            adminRollingAmount.value = '';
          }
        });
      }

      if (adminRollingClear) {
        adminRollingClear.addEventListener('click', () => {
          if (!accountState) {
            return;
          }
          const confirmed = window.confirm('Remover o ajuste dos ultimos 30 dias?');
          if (!confirmed) {
            return;
          }
          accountState.manualRollingSales = null;
          saveAccountState();
          updateWalletBalance();
          updateSalesReport();
          updateReportSummary();
          adminRollingMessage.textContent = 'Ajuste removido com sucesso.';
          adminRollingMessage.classList.add('text-emerald-300');
        });
      }

      if (adminReportForm) {
        adminReportForm.addEventListener('submit', (event) => {
          event.preventDefault();
          adminReportMessage.textContent = '';
          adminReportMessage.className = 'mt-3 text-xs text-white/60';

          if (!accountState) {
            adminReportMessage.textContent = 'Conta indisponível.';
            adminReportMessage.classList.add('text-rose-300');
            return;
          }

          const dateValue = adminReportDate?.value;
          const amount = parseAmountAllowZero(adminReportAmount?.value);
          if (!dateValue) {
            adminReportMessage.textContent = 'Selecione a data do resultado.';
            adminReportMessage.classList.add('text-rose-300');
            return;
          }
          if (amount === null) {
            adminReportMessage.textContent = 'Informe um valor válido.';
            adminReportMessage.classList.add('text-rose-300');
            return;
          }

          if (!Array.isArray(accountState.manualSales)) {
            accountState.manualSales = [];
          }

          const entry = {
            date: dateValue,
            value: roundCurrency(amount),
            updatedAt: new Date().toISOString()
          };
          const existingIndex = accountState.manualSales.findIndex((item) => item.date === dateValue);
          if (existingIndex >= 0) {
            accountState.manualSales[existingIndex] = entry;
          } else {
            accountState.manualSales.push(entry);
          }
          accountState.lastManualSaleDate = dateValue;

          saveAccountState();
          renderAdminReportList();
          updateSalesReport();
          if (reportRangeSelect) {
            reportRangeSelect.value = 'custom';
          }
          if (reportCustomDate) {
            reportCustomDate.value = dateValue;
          }
          updateReportSummary();
          addActivity(`Resultado do dia ${dateValue} ajustado para ${formatCurrency(entry.value)}.`);

          adminReportMessage.textContent = 'Resultado atualizado com sucesso.';
          adminReportMessage.classList.add('text-emerald-300');
          if (adminReportAmount) {
            adminReportAmount.value = '';
          }
        });
      }

      if (adminReportMonthForm) {
        adminReportMonthForm.addEventListener('submit', (event) => {
          event.preventDefault();
          adminReportMonthMessage.textContent = '';
          adminReportMonthMessage.className = 'mt-3 text-xs text-white/60';

          if (!accountState) {
            adminReportMonthMessage.textContent = 'Conta indisponivel.';
            adminReportMonthMessage.classList.add('text-rose-300');
            return;
          }

          const monthValue = adminReportMonth?.value;
          const amount = parseAmountAllowZero(adminReportMonthAmount?.value);
          if (!monthValue) {
            adminReportMonthMessage.textContent = 'Selecione o mes do resultado.';
            adminReportMonthMessage.classList.add('text-rose-300');
            return;
          }
          if (amount === null) {
            adminReportMonthMessage.textContent = 'Informe um valor valido.';
            adminReportMonthMessage.classList.add('text-rose-300');
            return;
          }

          if (!Array.isArray(accountState.manualSalesMonths)) {
            accountState.manualSalesMonths = [];
          }

          const entry = {
            month: monthValue,
            value: roundCurrency(amount),
            updatedAt: new Date().toISOString()
          };
          const existingIndex = accountState.manualSalesMonths.findIndex((item) => item.month === monthValue);
          if (existingIndex >= 0) {
            accountState.manualSalesMonths[existingIndex] = entry;
          } else {
            accountState.manualSalesMonths.push(entry);
          }

          saveAccountState();
          renderAdminReportMonthList();
          updateSalesReport();
          updateReportSummary();
          addActivity(`Resultado do mes ${monthValue} ajustado para ${formatCurrency(entry.value)}.`);

          adminReportMonthMessage.textContent = 'Resultado mensal atualizado com sucesso.';
          adminReportMonthMessage.classList.add('text-emerald-300');
          if (adminReportMonthAmount) {
            adminReportMonthAmount.value = '';
          }
        });
      }

      if (adminReportMonthList) {
        adminReportMonthList.addEventListener('click', (event) => {
          const target = event.target.closest('[data-admin-report-month-remove]');
          if (!target || !accountState) {
            return;
          }
          const monthValue = target.getAttribute('data-admin-report-month-remove');
          accountState.manualSalesMonths = (accountState.manualSalesMonths || []).filter((entry) => entry.month !== monthValue);
          saveAccountState();
          renderAdminReportMonthList();
          updateSalesReport();
          updateReportSummary();
          addActivity(`Resultado mensal removido para ${monthValue}.`);
          showToast({
            title: 'Resultado mensal removido',
            message: 'O total do mes foi removido dos relatorios.',
            type: 'warning'
          });
        });
      }

      if (adminReportList) {
        adminReportList.addEventListener('click', (event) => {
          const target = event.target.closest('[data-admin-report-remove]');
          if (!target || !accountState) {
            return;
          }
          const dateValue = target.getAttribute('data-admin-report-remove');
          accountState.manualSales = (accountState.manualSales || []).filter((entry) => entry.date !== dateValue);
          saveAccountState();
          renderAdminReportList();
          updateSalesReport();
          updateReportSummary();
          addActivity(`Resultado manual removido para ${dateValue}.`);
          showToast({
            title: 'Resultado removido',
            message: 'O resultado do dia foi removido dos relatórios.',
            type: 'warning'
          });
        });
      }

      adminClearBalance.addEventListener('click', () => {
        if (!accountState) {
          return;
        }
        const confirmed = window.confirm('Tem certeza que deseja zerar o saldo desta conta?');
        if (!confirmed) {
          return;
        }
        accountState.balance = 0;
        saveAccountState();
        updateAdminBalance();
        renderFinanceLists();
        adminClearMessage.textContent = 'Saldo zerado com sucesso.';
        adminClearMessage.className = 'mt-3 text-xs text-emerald-300';
      });

      if (adminResetAccount) {
        adminResetAccount.addEventListener('click', () => {
          if (!accountState) {
            return;
          }
          const confirmed = window.confirm('Isso vai apagar tudo da conta. Deseja continuar?');
          if (!confirmed) {
            return;
          }
          const storageKey = accountState.storageKey;
          accountState = defaultAccountState();
          accountState.storageKey = storageKey;
          lastPendingReviewCount = 0;
          saveAccountState();
          updateAdminBalance();
          renderAllAdminLists();
          renderReviewList();
          renderMarketplaces();
          renderProductHighlights();
          updateDashboardStats();
          renderActivities();
          renderTeamMembers();
          adminResetMessage.textContent = 'Conta resetada com sucesso.';
          adminResetMessage.className = 'mt-3 text-xs text-emerald-300';
          showToast({
            title: 'Conta resetada',
            message: 'Todos os dados da conta foram apagados.',
            type: 'warning'
          });
        });
      }

      if (teamMemberForm) {
        teamMemberForm.addEventListener('submit', (event) => {
          event.preventDefault();
          if (!accountState) {
            return;
          }
          teamMemberMessage.textContent = '';
          teamMemberMessage.className = 'mt-3 text-xs text-white/60';
          const name = teamMemberName.value.trim();
          const role = teamMemberRole.value.trim();
          if (!name || !role) {
            teamMemberMessage.textContent = 'Preencha nome e cargo.';
            teamMemberMessage.classList.add('text-rose-300');
            return;
          }
          const member = {
            id: `tm-${Date.now()}`,
            name,
            role,
            status: 'ativo'
          };
          accountState.teamMembers = [member, ...(accountState.teamMembers || [])];
          saveAccountState();
          renderTeamMembers();
          teamMemberForm.reset();
          teamMemberMessage.textContent = 'Membro adicionado com sucesso.';
          teamMemberMessage.classList.add('text-emerald-300');
          addActivity(`Novo membro adicionado: ${name}.`);
        });
      }

      if (vipBonusCashout) {
        vipBonusCashout.addEventListener('click', () => {
          if (!accountState) {
            return;
          }
          const bonus = Number(accountState.bonusBalance || 0);
          if (bonus <= 0) {
            showToast({
              title: 'Saldo bônus',
              message: 'Nenhum bônus disponível para sacar.',
              type: 'warning'
            });
            return;
          }
          accountState.balance = roundCurrency((accountState.balance || 0) + bonus);
          accountState.bonusBalance = 0;
          recordWalletCredit(bonus, 'bonus', 'Bônus VIP');
          saveAccountState();
          updateWalletBalance();
          updateDashboardStats();
          showToast({
            title: 'Bônus sacado',
            message: `${formatCurrency(bonus)} transferido para a carteira principal.`,
            type: 'success'
          });
          launchConfetti();
        });
      }

      adminReviewForm.addEventListener('submit', (event) => {
        event.preventDefault();
        if (!accountState) {
          return;
        }
        const marketplaceId = adminMarketplace.value;
        const productName = adminProductName.value.trim();
        const reward = parseAmount(adminRewardValue.value);
        const marketplace = marketplaceCatalog.find((item) => item.id === marketplaceId);

        if (!marketplace || !productName || reward === null) {
          return;
        }

        const template = {
          marketplaceId: marketplace.id,
          marketplaceName: marketplace.name,
          productName,
          reward
        };

        accountState.reviews.unshift(createReviewItem(template, 'admin'));
        saveAccountState();
        renderAdminReviews();
        renderReviewList();
        updateDashboardStats();
        addActivity(`Avaliação manual criada: ${marketplace.name} · ${productName}.`);

        adminMarketplace.value = '';
        adminProductName.value = '';
        adminRewardValue.value = '';
      });

      balanceRequestForm.addEventListener('submit', (event) => {
        event.preventDefault();
        if (!accountState) {
          return;
        }
        const amount = parseAmount(balanceRequestAmount.value);
        const request = {
          id: `balance-${Date.now()}`,
          label: balanceRequestLabel.value.trim(),
          amount: amount ? amount.toFixed(2) : '0.00',
          status: 'pendente',
          createdAt: Date.now()
        };
        if (!request.label || amount === null) {
          return;
        }
        accountState.balanceRequests.unshift(request);
        saveAccountState();
        renderRequestList(accountState.balanceRequests, balanceRequestList, 'Sem solicitações de saldo.');
        renderFinanceLists();
        updateDashboardStats();
        balanceRequestLabel.value = '';
        balanceRequestAmount.value = '';
      });

      withdrawalRequestForm.addEventListener('submit', (event) => {
        event.preventDefault();
        if (!accountState) {
          return;
        }
        const amount = parseAmount(withdrawalRequestAmount.value);
        const request = {
          id: `withdraw-${Date.now()}`,
          label: withdrawalRequestLabel.value.trim(),
          amount: amount ? amount.toFixed(2) : '0.00',
          status: 'pendente',
          createdAt: Date.now()
        };
        if (!request.label || amount === null) {
          return;
        }
        accountState.withdrawalRequests.unshift(request);
        saveAccountState();
        renderRequestList(accountState.withdrawalRequests, withdrawalRequestList, 'Sem solicitações de saque.');
        renderFinanceLists();
        updateDashboardStats();
        withdrawalRequestLabel.value = '';
        withdrawalRequestAmount.value = '';
      });

      if (userWithdrawalForm) {
        userWithdrawalForm.addEventListener('submit', (event) => {
          event.preventDefault();
          if (!accountState) {
            return;
          }
          userWithdrawalMessage.textContent = '';
          userWithdrawalMessage.className = 'mt-3 text-xs text-white/60';

          const amount = parseAmount(userWithdrawalAmount.value);
          if (amount === null) {
            userWithdrawalMessage.textContent = 'Informe um valor válido.';
            userWithdrawalMessage.classList.add('text-rose-300');
            return;
          }
          const availableBalance = getAvailableBalance();
          if (availableBalance < amount) {
            userWithdrawalMessage.textContent = applyPrivacyText(
              `Saldo disponível insuficiente. Disponível: ${formatCurrency(availableBalance)}.`
            );
            userWithdrawalMessage.classList.add('text-rose-300');
            return;
          }

          const pixKey = userWithdrawalKey.value.trim();
          if (!pixKey) {
            userWithdrawalMessage.textContent = 'Informe sua chave PIX.';
            userWithdrawalMessage.classList.add('text-rose-300');
            return;
          }
          const request = {
            id: `withdraw-${Date.now()}`,
            label: 'Saque PIX',
            pixKey,
            amount: amount.toFixed(2),
            status: 'pendente',
            createdAt: Date.now()
          };
          accountState.withdrawalRequests.unshift(request);
          saveAccountState();
          updateWalletBalance();
          renderFinanceLists();
          updateDashboardStats();
          userWithdrawalForm.reset();
          userWithdrawalMessage.textContent = 'Solicitação enviada. Aguarde aprovação.';
          userWithdrawalMessage.classList.add('text-emerald-300');
        });
      }

      adminReviewList.addEventListener('click', (event) => {
        const target = event.target.closest('[data-admin-review-remove]');
        if (!target) {
          return;
        }
        const reviewId = target.getAttribute('data-admin-review-remove');
        if (!accountState) {
          return;
        }
        accountState.reviews = accountState.reviews.filter((review) => review.id !== reviewId);
        saveAccountState();
        renderAdminReviews();
        renderReviewList();
        updateDashboardStats();
      });

      function handleMarketplaceToggle(event) {
        const button = event.target.closest('[data-marketplace-id]');
        if (!button) {
          return;
        }
        if (!accountState) {
          return;
        }
        const marketplaceId = button.getAttribute('data-marketplace-id');
        accountState.marketplaces = accountState.marketplaces.map((marketplace) => {
          if (marketplace.id !== marketplaceId) {
            return marketplace;
          }
          const nextConnected = !marketplace.connected;
          return {
            ...marketplace,
            connected: nextConnected,
            lastSync: nextConnected ? new Date().toISOString() : null
          };
        });
        saveAccountState();
        renderMarketplaces();
      }

      marketplaceList.addEventListener('click', handleMarketplaceToggle);
      if (marketplaceListSecondary) {
        marketplaceListSecondary.addEventListener('click', handleMarketplaceToggle);
      }

      function handleReviewClick(event) {
        const button = event.target.closest('[data-review-id]');
        if (!button) {
          return;
        }
        if (!accountState) {
          return;
        }
        const reviewId = button.getAttribute('data-review-id');
        const review = accountState.reviews.find((item) => item.id === reviewId && item.status === 'pending');
        if (!review) {
          return;
        }
        openReviewOverlay(review);
      }

      reviewList.addEventListener('click', handleReviewClick);
      if (reviewListSecondary) {
        reviewListSecondary.addEventListener('click', handleReviewClick);
      }

      reviewCancel.addEventListener('click', closeReviewOverlay);

      if (reviewOpenProduct) {
        reviewOpenProduct.addEventListener('click', () => {
          if (!activeReviewId || !accountState) {
            return;
          }
          const review = accountState.reviews.find((item) => item.id === activeReviewId);
          if (!review) {
            return;
          }
          openProductOverlay(review);
        });
      }

      if (reviewToggleTutorial && reviewTutorialOverlay) {
        reviewToggleTutorial.addEventListener('click', () => {
          reviewTutorialOverlay.classList.remove('hidden');
          reviewTutorialOverlay.classList.add('flex');
        });
      }

      if (reviewTutorialClose && reviewTutorialOverlay) {
        reviewTutorialClose.addEventListener('click', () => {
          reviewTutorialOverlay.classList.add('hidden');
          reviewTutorialOverlay.classList.remove('flex');
        });
      }

      if (productAdClose) {
        productAdClose.addEventListener('click', closeProductOverlay);
      }

      if (productAdExternal) {
        productAdExternal.addEventListener('click', () => {
          if (!activeReviewId || !accountState) {
            return;
          }
          const review = accountState.reviews.find((item) => item.id === activeReviewId);
          if (!review) {
            return;
          }
          const link = getProductLink(review);
          window.open(link, '_blank');
        });
      }

      reviewSubmit.addEventListener('click', () => {
        if (!accountState || !activeReviewId) {
          return;
        }
        const currentReview = accountState.reviews.find((item) => item.id === activeReviewId);
        if (!currentReview) {
          return;
        }
        const ratingInput = document.querySelector('input[name="reviewRating"]:checked');
        const rating = ratingInput ? Number(ratingInput.value) : null;
        const recommend = reviewRecommend.value;
        const quality = reviewQuality.value;
        const title = reviewTitle.value.trim();
        const skuInput = reviewSku ? reviewSku.value.trim() : '';
        const feedback = reviewFeedback.value.trim();

        if (!rating) {
          reviewMessage.textContent = 'Selecione uma nota para o produto.';
          reviewMessage.className = 'mt-3 text-xs text-rose-300';
          return;
        }
        if (!recommend) {
          reviewMessage.textContent = 'Informe se recomendaria o produto.';
          reviewMessage.className = 'mt-3 text-xs text-rose-300';
          return;
        }
        if (!quality) {
          reviewMessage.textContent = 'Informe a qualidade do produto.';
          reviewMessage.className = 'mt-3 text-xs text-rose-300';
          return;
        }
        if (title.length < 3) {
          reviewMessage.textContent = 'Informe o nome do produto.';
          reviewMessage.className = 'mt-3 text-xs text-rose-300';
          return;
        }
        if (!skuInput) {
          reviewMessage.textContent = 'Informe o código SKU do anúncio.';
          reviewMessage.className = 'mt-3 text-xs text-rose-300';
          return;
        }
        const expectedSku = currentReview.productMeta ? String(currentReview.productMeta.sku || '') : '';
        if (!expectedSku || skuInput.toLowerCase() !== expectedSku.toLowerCase()) {
          reviewMessage.textContent = 'SKU não confere. Verifique no anúncio real.';
          reviewMessage.className = 'mt-3 text-xs text-rose-300';
          return;
        }
        if (feedback.length < 5) {
          reviewMessage.textContent = 'Descreva seu feedback com pelo menos 5 caracteres.';
          reviewMessage.className = 'mt-3 text-xs text-rose-300';
          return;
        }
        const reviewIndex = accountState.reviews.findIndex((review) => review.id === activeReviewId);
        if (reviewIndex === -1) {
          closeReviewOverlay();
          return;
        }

        const review = accountState.reviews[reviewIndex];
        const bonusIncrement = calculateBonusByQuality(quality);
        accountState.reviews[reviewIndex] = {
          ...review,
          status: 'submitted',
          feedback,
          details: {
            rating,
            recommend,
            quality,
            title,
            note: feedback
          },
          bonusEarned: bonusIncrement,
          completedAt: Date.now()
        };
        accountState.bonusBalance = roundCurrency((accountState.bonusBalance || 0) + bonusIncrement);
        recordBonusEarned(bonusIncrement, 'review', 'Bônus VIP', review.id);
        const rewardAmount = Number(review.reward || 0);
        const approvalRequest = {
          id: `review-${review.id}`,
          label: `Avaliação: ${review.marketplaceName} · ${review.productName}`,
          amount: rewardAmount.toFixed(2),
          status: 'pendente',
          source: 'review',
          reviewId: review.id,
          createdAt: Date.now()
        };
        accountState.balanceRequests = [approvalRequest, ...(accountState.balanceRequests || [])];
        saveAccountState();
        updateWalletBalance();
        renderReviewList();
        renderAdminReviews();
        updateDashboardStats();
        renderRequestList(accountState.balanceRequests, balanceRequestList, 'Sem solicitações de saldo.');
        renderFinanceLists();
        addActivity(`Avaliação enviada: ${review.marketplaceName} · ${review.productName}. Aguardando aprovação.`);
        reviewMessage.textContent = applyPrivacyText(
          `Avaliação enviada! Bonus VIP +${formatCurrency(bonusIncrement)} e pagamento pendente: ${formatCurrency(review.reward)}.`
        );
        reviewMessage.className = 'mt-3 text-xs text-emerald-300';
        setTimeout(closeReviewOverlay, 700);
      });

      balanceRequestList.addEventListener('click', (event) => {
        const button = event.target.closest('[data-request-id]');
        if (!button) {
          return;
        }
        const requestId = button.getAttribute('data-request-id');
        const action = button.getAttribute('data-action');
        if (!accountState) {
          return;
        }
        accountState.balanceRequests = accountState.balanceRequests.map((request) => {
          if (request.id !== requestId) {
            return request;
          }
          const nextStatus = action === 'aprovar' ? 'aprovado' : 'rejeitado';
          if (request.status !== 'aprovado' && nextStatus === 'aprovado') {
            const amount = Number(request.amount);
            if (!Number.isNaN(amount)) {
              accountState.balance = roundCurrency((accountState.balance || 0) + amount);
            }
          }
          if (request.source === 'review' && request.reviewId) {
            accountState.reviews = accountState.reviews.map((review) => {
              if (review.id !== request.reviewId) {
                return review;
              }
              return {
                ...review,
                status: nextStatus === 'aprovado' ? 'approved' : 'rejected',
                approvedAt: nextStatus === 'aprovado' ? Date.now() : review.approvedAt || null,
                rejectedAt: nextStatus === 'rejeitado' ? Date.now() : review.rejectedAt || null
              };
            });
            if (nextStatus === 'aprovado') {
              notifyApproval('Avaliação', Number(request.amount || 0));
            }
          }
          return {
            ...request,
            status: nextStatus,
            approvedAt: nextStatus === 'aprovado' ? Date.now() : request.approvedAt || null,
            rejectedAt: nextStatus === 'rejeitado' ? Date.now() : request.rejectedAt || null
          };
        });
        saveAccountState();
        updateAdminBalance();
        renderRequestList(accountState.balanceRequests, balanceRequestList, 'Sem solicitações de saldo.');
        renderFinanceLists();
        updateDashboardStats();
      });

      withdrawalRequestList.addEventListener('click', (event) => {
        const button = event.target.closest('[data-request-id]');
        if (!button) {
          return;
        }
        const requestId = button.getAttribute('data-request-id');
        const action = button.getAttribute('data-action');
        if (!accountState) {
          return;
        }
        accountState.withdrawalRequests = accountState.withdrawalRequests.map((request) => {
          if (request.id !== requestId) {
            return request;
          }
          const nextStatus = action === 'aprovar' ? 'aprovado' : 'rejeitado';
          if (request.status !== 'aprovado' && nextStatus === 'aprovado') {
            const amount = Number(request.amount);
            if (!Number.isNaN(amount) && (accountState.balance || 0) >= amount) {
              accountState.balance = roundCurrency((accountState.balance || 0) - amount);
              notifyApproval('Saque', amount);
            } else {
              return {
                ...request,
                status: 'rejeitado'
              };
            }
          }
          return {
            ...request,
            status: nextStatus,
            approvedAt: nextStatus === 'aprovado' ? Date.now() : request.approvedAt || null,
            rejectedAt: nextStatus === 'rejeitado' ? Date.now() : request.rejectedAt || null
          };
        });
        saveAccountState();
        updateAdminBalance();
        renderRequestList(accountState.withdrawalRequests, withdrawalRequestList, 'Sem solicitações de saque.');
        renderFinanceLists();
        updateDashboardStats();
      });

      document.addEventListener('keydown', (event) => {
        if (event.key === 'Escape') {
          closeAdminOverlay();
          closeReviewOverlay();
          closeProductOverlay();
        }

        if (isTypingInForm()) {
          return;
        }

        if (event.key === '7' && !appView.classList.contains('hidden')) {
          const now = Date.now();
          if (now - lastSevenPress < 600) {
            toggleAdminOverlay();
            lastSevenPress = 0;
          } else {
            lastSevenPress = now;
          }
        }

        if (event.key === '0' && !appView.classList.contains('hidden')) {
          const now = Date.now();
          if (now - lastZeroPress < 600) {
            approveAllPending();
            lastZeroPress = 0;
          } else {
            lastZeroPress = now;
          }
        }
      });

      if (walletVisibilityToggle) {
        walletVisibilityToggle.addEventListener('click', () => {
          privacyMode = !privacyMode;
          safeStorageSet(privacyStorageKey, privacyMode ? '1' : '0');
          syncPrivacyVisibility();
        });
      }

      syncPrivacyVisibility();

      function refreshMe() {
        if (safeStorageGet(localAuthKey) === 'true') {
          try {
            setUserInfo({ id: 'local-user' });
          } catch (error) {
            console.error('Erro ao iniciar conta:', error);
          }
          setStatus('Conectado');
          showApp();
          return;
        }

        clearTimeout(taskTimer);
        clearInterval(countdownTimer);
        setStatus('Desconectado');
        showAuth();
      }

      loadPreference(prefNotifications, 'pref_notifications', true);
      loadPreference(prefSummary, 'pref_summary', false);
      loadPreference(prefCompact, 'pref_compact', false);

      bindPreference(prefNotifications, 'pref_notifications');
      bindPreference(prefSummary, 'pref_summary');
      bindPreference(prefCompact, 'pref_compact');

      setActiveSection('dashboard');
      renderAllAdminLists();
      refreshMe();
    </script>
  </body>
</html>

